!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ANSWERS=t()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){r(e,t,n[t])})}return e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t,n){return(u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&l(r,n.prototype),r}).apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return(c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return u(e,arguments,s(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l(i,e)})(e)}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var g={PRE_SEARCH:"pre-search",SEARCH_LOADING:"search-loading",SEARCH_COMPLETE:"search-complete"},v=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this._raw=n.raw||null,this._formatted=n.formatted,this._highlighted=n.highlighted,this.ordinal=n.ordinal||null,this.title=n.title||null,this.details=n.details||null,this.link=n.link||null,this.id=n.id||null,this.subtitle=n.subtitle||null,this.modifier=n.modifier||null,this.bigDate=n.bigDate||null,this.image=n.image||null,this.callsToAction=n.callsToAction||[],this.collapsed=n.collapsed||!0},y=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.value=n.value||n.shortValue||"",this.matchedSubstrings=n.matchedSubstrings||[]}return i(e,[{key:"get",value:function(){return this._sortMatchedSubstrings(),this.buildHighlightedValue(this.value,this.matchedSubstrings)}},{key:"getInverted",value:function(){this._sortMatchedSubstrings();var e=this._getInvertedSubstrings(this.matchedSubstrings,this.value.length);return this.buildHighlightedValue(this.value,e)}},{key:"buildHighlightedValue",value:function(e,t){var n="",i=0;if(0===t.length)return e;for(var r=0;r<t.length;r++){var o=Number(t[r].offset),a=o+t[r].length;n+=[e.slice(i,o),"<strong>",e.slice(o,a),"</strong>"].join(""),r===t.length-1&&a<e.length&&(n+=e.slice(a)),i=a}return n}},{key:"_sortMatchedSubstrings",value:function(){this.matchedSubstrings.sort(function(e,t){return e.offset<t.offset?-1:e.offset>t.offset?1:0})}},{key:"_getInvertedSubstrings",value:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=r.offset+r.length;0===i&&0!==r.offset&&n.push({offset:0,length:r.offset}),t>o&&n.push({offset:o,length:i<e.length-1?e[i+1].offset-o:t-o})}return n}}]),e}(),m=function(e){function n(e,i,r,o){var a;return t(this,n),(a=h(this,s(n).call(this,i))).errorCode=e,a.errorMessage=i,a.boundary=r,a.reported=!1,o&&(a.causedBy=o instanceof n?o:n.from(o)),a}return a(n,c(Error)),i(n,[{key:"toJson",value:function(){return JSON.stringify(this)}},{key:"toString",value:function(){var e="".concat(this.errorMessage," (").concat(this.boundary,")");return this.causedBy&&(e+="\n  Caused By: ".concat(this.causedBy.toString())),e}}],[{key:"from",value:function(e,t){var n=new _(e.message,t);return n.stack=e.stack,n}}]),n}(),_=function(e){function n(e,i,r){return t(this,n),h(this,s(n).call(this,100,e,i,r))}return a(n,m),n}(),S=function(e){function n(e,i,r){return t(this,n),h(this,s(n).call(this,101,e,i,r))}return a(n,m),n}(),b=function(e){function n(e,i,r){return t(this,n),h(this,s(n).call(this,201,e,i,r))}return a(n,m),n}(),k=function(e){function n(e,i,r){return t(this,n),h(this,s(n).call(this,300,e,i,r))}return a(n,m),n}(),w=function(e){function n(e,i,r){return t(this,n),h(this,s(n).call(this,400,e,i,r))}return a(n,m),n}(),C=function(e){function n(e,i,r,o){var a;return t(this,n),(a=h(this,s(n).call(this,401,e,"Storage",o))).storageKey=i,a.data=r,a}return a(n,m),n}(),E=function(e){function n(e,i,r){var o;return t(this,n),(o=h(this,s(n).call(this,402,e,"Analytics",r))).event=i,o}return a(n,m),n}(),L=function(){function n(){t(this,n)}return i(n,null,[{key:"from",value:function(e,t,i,r){for(var o=[],a=0;a<e.length;a++){var s=e[a].data||e[a];switch(r){case"GOOGLE_CSE":o.push(n.fromGoogleCustomSearchEngine(s));break;case"BING_CSE":o.push(n.fromBingCustomSearchEngine(s));break;case"ZENDESK":o.push(n.fromZendeskSearchEngine(s));break;case"ALGOLIA":o.push(n.fromAlgoliaSearchEngine(s));break;case"KNOWLEDGE_MANAGER":var l=e[a].highlightedFields||{};o.push(n.fromKnowledgeManager(s,t,i,l,a));break;default:o.push(n.fromGeneric(s,a))}}return o}},{key:"computeFormattedData",value:function(e,t,n,i){if(0===Object.keys(t).length)return{};var r={};return Object.entries(e).forEach(function(o){var a=p(o,2),s=a[0],l=a[1];if(void 0!==t[s]){if("function"!=typeof t[s])throw new w("Field formatter is not of expected type function","ResultFactory");var u=null;i&&i[s]&&(u=i[s]),r[s]=t[s]({entityProfileData:e,entityFieldValue:l,highlightedEntityFieldValue:u,verticalId:n,isDirectAnswer:!1})}}),r}},{key:"computeHighlightedData",value:function(t,i){if(0===Object.keys(i).length)return{};var r={};return Object.entries(i).forEach(function(o){var a=p(o,1)[0];if(void 0===t[a])throw new w("Highlighted Field Name does not exist in Entity Profile","ResultFactory");var s=i[a];if("object"===e(s)&&Object.keys(s).length>0&&void 0===s.matchedSubstrings)r[a]=n.computeHighlightedData(t[a],i[a]);else{var l=new y(t).buildHighlightedValue(s.value,s.matchedSubstrings);r[a]=l}}),r}},{key:"fromGeneric",value:function(e,t){return new v({raw:e,title:e.name,details:this.truncate(e.description),link:e.website,id:e.id,ordinal:t+1})}},{key:"fromKnowledgeManager",value:function(e,t,i,r,o){var a=n.computeHighlightedData(e,r),s=n.computeFormattedData(e,t,i,a),l=null;return l=void 0!==s.description?s.description:void 0!==a.description?this.truncate(a.description):this.truncate(e.description),new v({raw:e,formatted:s,highlighted:a,title:s.name||e.name,details:l,link:e.website,id:e.id,ordinal:o+1})}},{key:"fromGoogleCustomSearchEngine",value:function(e){return new v({raw:e,title:e.htmlTitle.replace(/(<([^>]+)>)/gi,""),details:e.htmlSnippet,link:e.link})}},{key:"fromBingCustomSearchEngine",value:function(e){return new v({raw:e,title:e.name,details:e.snippet,link:e.url})}},{key:"fromZendeskSearchEngine",value:function(e){return new v({raw:e,title:e.title,details:e.snippet,link:e.html_url})}},{key:"fromAlgoliaSearchEngine",value:function(e){return new v({raw:e,details:e.objectID,id:e.objectID})}},{key:"truncate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ";if(!e||e.length<=t)return e;for(var r=e.split(i),o=t-n.length,a="",s=0;s<r.length;s++){var l=r[s];if(a.length+l.length>o||0!==s&&a.length+l.length+i.length>o){a+=n;break}a+=0===s?l:i+l}return a}}]),n}(),I=function(){function e(n,i,r){t(this,e),this.searchState=g.SEARCH_COMPLETE,this.verticalConfigId=n.verticalConfigId||null,this.resultsCount=n.resultsCount||0,this.encodedState=n.encodedState||"",this.appliedQueryFilters=O.from(n.appliedQueryFilters),this.facets=n.facets||null,this.results=L.from(n.results,r,this.verticalConfigId,n.source),this.map=e.parseMap(n.results),this.verticalURL=i||null}return i(e,null,[{key:"parseMap",value:function(e){for(var t=[],n={},i=0;i<e.length;i++){var r=e[i].data||e[i];r&&r.yextDisplayCoordinate&&(n.latitude||(n={latitude:r.yextDisplayCoordinate.latitude,longitude:r.yextDisplayCoordinate.longitude}),t.push({item:r,label:t.length+1,latitude:r.yextDisplayCoordinate.latitude,longitude:r.yextDisplayCoordinate.longitude}))}return{mapCenter:n,mapMarkers:t}}},{key:"from",value:function(t,n,i){var r=[];if(!t)return r;if(!Array.isArray(t))return new e(t,null,i);for(var o=0;o<t.length;o++)r.push(new e(t[o],n[t[o].verticalConfigId],i));return r}}]),e}(),O=function(){function e(n){t(this,e),this.key=n.key||n.displayKey,this.value=n.value||n.displayValue}return i(e,null,[{key:"from",value:function(t){for(var n=[],i=0;i<t.length;i++)n.push(new e(t[i]));return n}}]),e}(),T=function(){function e(n){t(this,e),this.queryId=n.queryId||null,this.sections=n.sections||[],this.searchState=n.searchState||g.SEARCH_COMPLETE}return i(e,null,[{key:"from",value:function(t,n,i){return new e({queryId:t.queryId,sections:I.from(t.modules,n,i)})}},{key:"searchLoading",value:function(){return new e({searchState:g.SEARCH_LOADING})}}]),e}(),x=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),Object.assign(this,n),Object.freeze(this)}return i(e,null,[{key:"from",value:function(t,n){var i=o({},t),r=i.answer,a=i.relatedItem;return r&&n[r.fieldApiName]&&(r.value=n[r.fieldApiName](r.value,a.data.fieldValues,a.verticalConfigId,!0)),new e(i)}}]),e}(),A=function(){function e(n){t(this,e),this.tabOrder=n||[],Object.freeze(this)}return i(e,null,[{key:"from",value:function(t){var n=[];if(!t||!Array.isArray(t))return n;for(var i=0;i<t.length;i++)n.push(t[i].verticalConfigId);return new e(n)}}]),e}(),R=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),Object.assign(this,{searchState:g.SEARCH_COMPLETE},n),Object.freeze(this)}return i(e,[{key:"append",value:function(t){var n=o({},this);return n.results=this.results.concat(t.results),n.map.mapMarkers=this.map.mapMarkers.concat(t.map.mapMarkers),new e(n)}}],[{key:"from",value:function(t,n){return new e(I.from(t,null,n))}},{key:"searchLoading",value:function(){return new e({searchState:g.SEARCH_LOADING})}},{key:"areDuplicateNamesAllowed",value:function(){return!0}}]),e}(),F=function(){function e(n){t(this,e),this.query=n.query||null,this.correctedQuery=n.correctedQuery||null,this.correctedQueryDisplay=n.correctedQueryDisplay||null,this.type=n.type||null,this.shouldShow=null!==this.correctedQuery}return i(e,null,[{key:"from",value:function(t){return t?new e({query:t.originalQuery,correctedQuery:t.correctedQuery,correctedQueryDisplay:new y(t.correctedQuery).get(),type:t.type}):{}}}]),e}(),N={NAVIGATION:"navigation",UNIVERSAL_RESULTS:"universal-results",VERTICAL_RESULTS:"vertical-results",AUTOCOMPLETE:"autocomplete",DIRECT_ANSWER:"direct-answer",FILTER:"filter",QUERY:"query",QUERY_ID:"query-id",FACET_FILTER:"facet-filter",DYNAMIC_FILTERS:"dynamic-filters",PARAMS:"params",GEOLOCATION:"geolocation",INTENTS:"intents",QUESTION_SUBMISSION:"question-submission",SEARCH_CONFIG:"search-config",SEARCH_OFFSET:"search-offset",SPELL_CHECK:"spell-check",LOCATION_BIAS:"location-bias",SESSIONS_OPT_IN:"sessions-opt-in"},M=function(){function e(n){t(this,e),this.filters=n.filters||[],Object.freeze(this)}return i(e,null,[{key:"from",value:function(t){return new e({filters:t.facets.map(function(e){return{label:e.displayName,fieldId:e.fieldId,options:e.options.map(function(e){return{label:e.displayName,countLabel:e.count,selected:e.selected,filter:e.filter}})}})})}}]),e}(),q=function(){function e(n){t(this,e),this.nearMe=n.nearMe,Object.freeze(this)}return i(e,null,[{key:"from",value:function(t){return new e({nearMe:(t||[]).includes("NEAR_ME")})}}]),e}(),U=function(){function e(n){t(this,e),this.accuracy=n.accuracy||null,this.latitude=n.latitude||null,this.longitude=n.longitude||null,this.locationDisplayName=n.locationDisplayName||null}return i(e,null,[{key:"from",value:function(t){return new e(t?{accuracy:t.accuracy,latitude:t.latitude,longitude:t.longitude,locationDisplayName:t.locationDisplayName}:{accuracy:"UNKNOWN"})}}]),e}(),K=function(){function e(){t(this,e)}return i(e,null,[{key:"transform",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=e.response;return r(t={},N.QUERY_ID,o.queryId),r(t,N.NAVIGATION,A.from(o.modules)),r(t,N.DIRECT_ANSWER,x.from(o.directAnswer,i)),r(t,N.UNIVERSAL_RESULTS,T.from(o,n,i)),r(t,N.INTENTS,q.from(o.searchIntents)),r(t,N.SPELL_CHECK,F.from(o.spellCheck)),r(t,N.LOCATION_BIAS,U.from(o.locationBias)),t}},{key:"transformVertical",value:function(e,t){var n;return r(n={},N.QUERY_ID,e.response.queryId),r(n,N.NAVIGATION,new A),r(n,N.VERTICAL_RESULTS,R.from(e.response,t)),r(n,N.DYNAMIC_FILTERS,M.from(e.response)),r(n,N.INTENTS,q.from(e.response.searchIntents)),r(n,N.SPELL_CHECK,F.from(e.response.spellCheck)),r(n,N.LOCATION_BIAS,U.from(e.response.locationBias)),n}}]),e}(),D=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;t(this,e),this.name=n.name||null,this.email=n.email||null,this.privacyPolicy=n.privacyPolicy||null,this.questionText=n.questionText||null,this.questionDescription=n.questionDescription||null,this.errors=i||null,Object.freeze(this)}return i(e,null,[{key:"submitted",value:function(){return{questionSubmitted:!0}}},{key:"errors",value:function(t,n){return e(t,n)}}]),e}(),P=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),Object.assign(this,n),Object.freeze(this)}return i(e,null,[{key:"fromResponse",value:function(t){return new e(JSON.parse(t))}},{key:"or",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return new e({$or:n})}},{key:"and",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return new e({$and:n})}},{key:"group",value:function(){for(var t={},n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(var o=0,a=i;o<a.length;o++){var s=a[o],l=Object.keys(s)[0];t[l]||(t[l]=[]),t[l].push(s)}for(var u=[],c=0,h=Object.keys(t);c<h.length;c++){var f=h[c];u.push(t[f].length>1?e.or.apply(e,d(t[f])):t[f][0])}return u.length>1?e.and.apply(e,u):u[0]}},{key:"equal",value:function(t,n){return e._fromMatcher(t,"$eq",n)}},{key:"lessThan",value:function(t,n){return e._fromMatcher(t,"$lt",n)}},{key:"lessThanEqual",value:function(t,n){return e._fromMatcher(t,"$le",n)}},{key:"greaterThan",value:function(t,n){return e._fromMatcher(t,"$gt",n)}},{key:"greaterThanEqual",value:function(t,n){return e._fromMatcher(t,"$ge",n)}},{key:"inclusiveRange",value:function(t,n,i){return new e(r({},t,{$ge:n,$le:i}))}},{key:"exclusiveRange",value:function(t,n,i){return new e(r({},t,{$gt:n,$lt:i}))}},{key:"position",value:function(t,n,i){return e._fromMatcher("builtin.location","$near",{lat:t,lng:n,radius:i})}},{key:"_fromMatcher",value:function(t,n,i){return new e(r({},t,r({},n,i)))}}]),e}(),H=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this._apiKey=n.apiKey,this._experienceKey=n.experienceKey,this._experienceVersion=n.experienceVersion,this._locale=n.locale,this._fieldFormatters=n.fieldFormatters||{},this.globalStorage=n.globalStorage,this.persistentStorage=n.persistentStorage,this._searcher=n.searchService,this._autoComplete=n.autoCompleteService,this._questionAnswer=n.questionAnswerService}return i(e,[{key:"verticalSearch",value:function(e,t){var n=this;return t.append||(this.globalStorage.set(N.VERTICAL_RESULTS,R.searchLoading()),this.globalStorage.set(N.SPELL_CHECK,{}),this.globalStorage.set(N.LOCATION_BIAS,{})),this._searcher.verticalSearch(e,o({limit:this.globalStorage.getState(N.SEARCH_CONFIG).limit,geolocation:this.globalStorage.getState(N.GEOLOCATION)},t,{isDynamicFiltersEnabled:this._isDynamicFiltersEnabled,skipSpellCheck:this.globalStorage.getState("skipSpellCheck"),queryTrigger:this.globalStorage.getState("queryTrigger"),sessionTrackingEnabled:this.globalStorage.getState(N.SESSIONS_OPT_IN)})).then(function(e){return K.transformVertical(e,n._fieldFormatters)}).then(function(e){if(n.globalStorage.set(N.QUERY_ID,e[N.QUERY_ID]),n.globalStorage.set(N.NAVIGATION,e[N.NAVIGATION]),n.globalStorage.set(N.INTENTS,e[N.INTENTS]),t.append){var i=n.globalStorage.getState(N.VERTICAL_RESULTS).append(e[N.VERTICAL_RESULTS]);n.globalStorage.set(N.VERTICAL_RESULTS,i)}else n.globalStorage.set(N.VERTICAL_RESULTS,e[N.VERTICAL_RESULTS]);e[N.DYNAMIC_FILTERS]&&n.globalStorage.set(N.DYNAMIC_FILTERS,e[N.DYNAMIC_FILTERS]),e[N.SPELL_CHECK]&&n.globalStorage.set(N.SPELL_CHECK,e[N.SPELL_CHECK]),e[N.LOCATION_BIAS]&&n.globalStorage.set(N.LOCATION_BIAS,e[N.LOCATION_BIAS]),n.globalStorage.delete("skipSpellCheck"),n.globalStorage.delete("queryTrigger")})}},{key:"verticalPage",value:function(e,t){var n=this.globalStorage.getAll(N.FILTER),i=n.length>1?P.and.apply(P,d(n)):n[0],r=this.globalStorage.getAll(N.FACET_FILTER)[0];this.verticalSearch(e,{input:this.globalStorage.getState(N.QUERY),id:this.globalStorage.getState(N.QUERY_ID),filter:JSON.stringify(i),facetFilter:JSON.stringify(r),offset:t})}},{key:"search",value:function(e,t){var n=this;return this.globalStorage.set(N.DIRECT_ANSWER,{}),this.globalStorage.set(N.UNIVERSAL_RESULTS,T.searchLoading()),this.globalStorage.set(N.QUESTION_SUBMISSION,{}),this.globalStorage.set(N.SPELL_CHECK,{}),this.globalStorage.set(N.LOCATION_BIAS,{}),this._searcher.universalSearch(e,{geolocation:this.globalStorage.getState(N.GEOLOCATION),skipSpellCheck:this.globalStorage.getState("skipSpellCheck"),queryTrigger:this.globalStorage.getState("queryTrigger"),sessionTrackingEnabled:this.globalStorage.getState(N.SESSIONS_OPT_IN)}).then(function(e){return K.transform(e,t,n._fieldFormatters)}).then(function(e){n.globalStorage.set(N.QUERY_ID,e[N.QUERY_ID]),n.globalStorage.set(N.NAVIGATION,e[N.NAVIGATION]),n.globalStorage.set(N.DIRECT_ANSWER,e[N.DIRECT_ANSWER]),n.globalStorage.set(N.UNIVERSAL_RESULTS,e[N.UNIVERSAL_RESULTS],t),n.globalStorage.set(N.INTENTS,e[N.INTENTS]),n.globalStorage.set(N.SPELL_CHECK,e[N.SPELL_CHECK]),n.globalStorage.set(N.LOCATION_BIAS,e[N.LOCATION_BIAS]),n.globalStorage.delete("skipSpellCheck"),n.globalStorage.delete("queryTrigger")})}},{key:"autoCompleteUniversal",value:function(e,t){var n=this;return this._autoComplete.queryUniversal(e).then(function(e){n.globalStorage.set("".concat(N.AUTOCOMPLETE,".").concat(t),e)})}},{key:"autoCompleteVertical",value:function(e,t,n,i){var r=this;return this._autoComplete.queryVertical(e,n,i).then(function(e){r.globalStorage.set("".concat(N.AUTOCOMPLETE,".").concat(t),e)})}},{key:"autoCompleteFilter",value:function(e,t){var n=this;return this._autoComplete.queryFilter(e,t).then(function(e){n.globalStorage.set("".concat(N.AUTOCOMPLETE,".").concat(t.namespace),e)})}},{key:"submitQuestion",value:function(e){var t=this;return this._questionAnswer.submitQuestion(e).then(function(e){t.globalStorage.set(N.QUESTION_SUBMISSION,D.submitted())})}},{key:"setQuery",value:function(e){this.globalStorage.set(N.QUERY,e)}},{key:"setQueryId",value:function(e){this.globalStorage.set(N.QUERY_ID,e)}},{key:"setFilter",value:function(e,t){this.globalStorage.set("".concat(N.FILTER,".").concat(e),t)}},{key:"setFacetFilter",value:function(e,t){this.globalStorage.set("".concat(N.FACET_FILTER,".").concat(e),t)}},{key:"enableDynamicFilters",value:function(){this._isDynamicFiltersEnabled=!0}},{key:"on",value:function(e,t,n){return this.globalStorage.on(e,t,n)}}]),e}(),j=window.document,V=function(){function e(){t(this,e)}return i(e,null,[{key:"setup",value:function(e,t){j=e}},{key:"create",value:function(e){if("createRange"in j){var t=j.createElement("div"),n=j.createRange().createContextualFragment(e);return t.appendChild(n),t}return(new DOMParser).parseFromString(e,"text/html").body}},{key:"query",value:function(e,t){return void 0===t&&(t=e,e=j),t instanceof HTMLElement||t instanceof Window||t instanceof HTMLDocument?t:e.querySelector(t)}},{key:"queryAll",value:function(e,t){return void 0===t&&(t=e,e=j),null==e&&(e=j),t instanceof HTMLElement||t instanceof HTMLDocument||t instanceof Window?[t]:Array.from(e.querySelectorAll(t))}},{key:"onReady",value:function(t){"complete"!==j.readyState&&"loaded"!==j.readyState&&"interactive"!==j.readyState?e.on(j,"DOMContentLoaded",t):t()}},{key:"createEl",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=j.createElement(t),r=Object.keys(n),o=0;o<r.length;o++)"class"!==r[o]?i[r[o]]=n[r[o]]:e.addClass(i,n[r[o]]);return i}},{key:"append",value:function(t,n){void 0===n&&(n=t,t=j),"string"==typeof t&&(t=e.query(t)),"string"==typeof n?t.insertAdjacentHTML("afterBegin",n):t.appendChild(n)}},{key:"addClass",value:function(e,t){for(var n=t.split(","),i=n.length,r=0;r<i;r++)e.classList.add(n[r])}},{key:"empty",value:function(e){e.innerHTML=""}},{key:"css",value:function(t,n){var i=e.query(t);for(var r in n)i.style[r]=n[r]}},{key:"attr",value:function(t,n,i){e.query(t).setAttribute(n,i)}},{key:"attributes",value:function(e,t){var n=this;Object.entries(t).forEach(function(t){var i=p(t,2),r=i[0],o=i[1];return n.attr(e,r,o)})}},{key:"trigger",value:function(t,n,i){var r=new Event(n,Object.assign({bubbles:!0,cancelable:!0},i||{}));e.query(t).dispatchEvent(r)}},{key:"on",value:function(t,n,i){e.query(t).addEventListener(n,i)}},{key:"once",value:function(t,n,i){e.query(t).addEventListener(n,i,{once:!0})}},{key:"off",value:function(t,n,i){e.query(t).removeEventListener(n,i)}},{key:"delegate",value:function(t,n,i,r){var o=e.query(t);o.addEventListener(i,function(e){for(var t=e.target;!t.isEqualNode(o);){if(t.matches(n)){r(e,t);break}t=t.parentNode}})}}]),e}(),B=function(){function e(){if(t(this,e),!e.setInstance(this))return e.getInstance();this._componentRegistry={},this._activeComponents=[],this._core=null,this._renderer=null,this._analyticsReporter=null}return i(e,[{key:"setRenderer",value:function(e){return this._renderer=e,this}},{key:"setCore",value:function(e){return this._core=e,this}},{key:"setAnalyticsReporter",value:function(e){return this._analyticsReporter=e,this}},{key:"register",value:function(e){return this._componentRegistry[e.type]=e,this}},{key:"create",value:function(e,t){var n={core:this._core,renderer:this._renderer,analyticsReporter:this._analyticsReporter,componentManager:this};if(!this._componentRegistry[e].areDuplicateNamesAllowed()&&this._activeComponents.some(function(e){return e.name===t.name}))throw new b("Another component with name ".concat(t.name," already exists"),e);var i=o({isTwin:this._activeComponents.some(function(t){return t.constructor.type===e})},t),r=new this._componentRegistry[e](i,n).init(i);if(this._activeComponents.push(r),this._core&&null!==this._core.globalStorage){if(void 0===r.moduleId||null===r.moduleId)return r;this._core.globalStorage.on("update",r.moduleId,function(e){r.setState(e)})}return r}},{key:"remove",value:function(e){this._core.globalStorage.off("update",e.moduleId);var t=this._activeComponents.findIndex(function(t){return t.name===e.name});this._activeComponents.splice(t,1)}},{key:"removeByName",value:function(e){var t=this._activeComponents.find(function(t){return t.name===e});t.remove(),V.empty(t._container)}},{key:"getActiveComponent",value:function(e){return this._activeComponents.find(function(t){return t.constructor.type===e})}}],[{key:"setInstance",value:function(e){return!this.instance&&(this.instance=e,!0)}},{key:"getInstance",value:function(){return this.instance}}]),e}(),z=function(){function e(){t(this,e)}return i(e,[{key:"render",value:function(e,t){return e}},{key:"registerHelper",value:function(e,t){}},{key:"compile",value:function(e){}}]),e}(),Q={SOY:z,Handlebars:function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(this,n),(e=h(this,s(n).call(this)))._handlebars=i._hb||null,e._templates=i||{},e}return a(n,z),i(n,[{key:"init",value:function(e){this._handlebars=e._hb,this._templates=e,this._registerCustomHelpers()}},{key:"registerHelper",value:function(e,t){this._handlebars.registerHelper(e,t)}},{key:"compile",value:function(e){return"string"!=typeof e?"":this._handlebars.compile(e)}},{key:"render",value:function(e,t){if(null!==e.template)return e.template(t);try{return this._templates[e.templateName](t)}catch(t){throw new Error("Can not find/render template: "+e.templateName,t)}}},{key:"_registerCustomHelpers",value:function(){this.registerHelper("ifeq",function(e,t,n){return e===t?n.fn(this):n.inverse(this)}),this.registerHelper("ifnoteq",function(e,t,n){return e!==t?n.fn(this):n.inverse(this)}),this.registerHelper("formatPhoneNumber",function(e){var t=(""+e).replace(/\D/g,"").match(/^(1|)?(\d{3})(\d{3})(\d{4})$/);return t?[t[1]?"+1 ":"","(",t[2],") ",t[3],"-",t[4]].join(""):null}),this.registerHelper("assign",function(e,t,n){var i=arguments;(n=i[i.length-1]).data.root||(n.data.root={});for(var r="",o=1;o<i.length-1;o++)r+=i[o];n.data.root[e]=r}),this.registerHelper("json",function(e,t,n){return void 0===e?"":JSON.stringify(e)})}}]),n}()},G=function(){function e(){t(this,e),this._listeners={}}return i(e,[{key:"on",value:function(e,t,n){if("function"!=typeof t)throw new Error("callback handler should be of type {function}");return void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push({event:e,cb:t,once:n||!1}),this}},{key:"once",value:function(e,t){return this.on(e,t,!0)}},{key:"off",value:function(e){return delete this._listeners[e],this}},{key:"emit",value:function(e,t){var n=this._listeners[e];if(void 0!==n){for(var i=[],r=0;r<n.length;r++)n[r].cb(t),!0!==n[r].once&&i.push(n[r]);return this._listeners[e]=i,this}}}]),e}(),Y=function(e){function n(e){var i;return t(this,n),(i=h(this,s(n).call(this)))._state=e||{},i}return a(n,G),i(n,[{key:"init",value:function(e,t){this._set(e,t)}},{key:"set",value:function(e,t){this._set(e,t),this.emit("update")}},{key:"_set",value:function(e,t){void 0===t?this._state=e:this._state[e]=t}},{key:"update",value:function(e){this._state=e,this.emit("update")}},{key:"get",value:function(e){return void 0===e?this._state:this._state[e]}},{key:"has",value:function(e){return void 0!==this._state[e]}},{key:"asJSON",value:function(){return this._state}}]),n}(),J="get",W="post",$=function(){function n(){t(this,n)}return i(n,[{key:"get",value:function(e,t,n){return this.request(J,this.encodeParams(e,t),n)}},{key:"post",value:function(e,t,n,i){return this.request(W,this.encodeParams(e,t),Object.assign({},{body:JSON.stringify(n),credentials:void 0},i))}},{key:"request",value:function(e,t,n){var i=Object.assign({},{method:e,credentials:"include"},n);return fetch(t,i)}},{key:"beacon",value:function(e,t){return navigator.sendBeacon(e,JSON.stringify(t))}},{key:"encodeParams",value:function(t,n){if("object"===e(n)){var i=t.indexOf("?")>-1,r="";for(var o in n)i?r+="&":(i=!0,r+="?"),r+=o+"="+encodeURIComponent(n[o]);return t+r}}}]),n}(),Z="https://liveapi.yext.com",X="https://assets.sitescdn.net/answers/".concat("v0.10.1","/answerstemplates.compiled.min.js"),ee="https://answers.yext-pixel.com",te=function(){function e(n){if(t(this,e),this._params={},window&&window.URLSearchParams)return new URLSearchParams(n);this._params=this.parse(n)}return i(e,[{key:"parse",value:function(t){var n={},i=t;if(""===i)return n;t.indexOf("?")>-1&&(i=t.slice(t.indexOf("?")+1));for(var r=i.split("&"),o=0;o<r.length;o++){var a=r[o].split("=");a.length>1?n[a[0]]=e.decode(a[1]):n[a[0]]=""}return n}},{key:"get",value:function(e){return void 0===this._params[String(e)]?null:this._params[e]}},{key:"set",value:function(e,t){this._params[String(e)]=String(t)}},{key:"has",value:function(e){return e in this._params}},{key:"toString",value:function(){var t=[];for(var n in this._params)t.push("".concat(n,"=").concat(e.encode(this._params[n])));return t.join("&")}},{key:"entries",value:function(){var e=[];for(var t in this._params)e.push([t,this._params[t]]);return e}}],[{key:"decode",value:function(e){return decodeURIComponent(e.replace(/[ +]/g,"%20"))}},{key:"encode",value:function(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","%20":"+"};return encodeURIComponent(e).replace(/[!'()]|%20/g,function(e){return t[e]})}}]),e}(),ne=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this._requester=new $,this._baseUrl=n.baseUrl||Z,this._endpoint=n.endpoint||null,this._apiKey=n.apiKey||null,this._version=n.version||20190101,this._params=n.params||{}}return i(e,[{key:"get",value:function(){return this._requester.get(this._baseUrl+this._endpoint,Object.assign({},this.baseParams(),this.sanitizeParams(this._params)))}},{key:"post",value:function(e){return this._requester.post(this._baseUrl+this._endpoint,this.baseParams(),this.sanitizeParams(this._params),e)}},{key:"baseParams",value:function(){var e={v:this._version,api_key:this._apiKey,jsLibVersion:"v0.10.1"},t=new te(window.location.search.substring(1));return t.has("beta")&&(e.beta=t.get("beta")),e}},{key:"sanitizeParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).forEach(function(t){void 0!==e[t]&&null!==e[t]||delete e[t]}),e}}]),e}(),ie=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t(this,e),!n.apiKey)throw new _("Api Key is required","Search");if(this._apiKey=n.apiKey,!n.experienceKey)throw new _("Answers Key is required","Search");if(this._experienceKey=n.experienceKey,this._experienceVersion=n.experienceVersion,this._version=n.version||20190101,!n.locale)throw new _("Locale is required","Search");this._locale=n.locale}return i(e,[{key:"verticalSearch",value:function(e,t){var n=t.input,i=t.filter,r=t.facetFilter,o=t.limit,a=t.offset,s=t.id,l=t.geolocation,u=t.isDynamicFiltersEnabled,c=t.skipSpellCheck,h=t.queryTrigger,f=t.sessionTrackingEnabled;if(o>50)throw new w("Provided search limit unsupported","SearchApi");return new ne({endpoint:"/v2/accounts/me/answers/vertical/query",apiKey:this._apiKey,version:this._version,params:{input:n,experienceKey:this._experienceKey,version:this._experienceVersion,filters:i,facetFilters:r,verticalKey:e,limit:o,offset:a,location:l?"".concat(l.lat,",").concat(l.lng):null,radius:l?l.radius:null,queryId:s,retrieveFacets:u,locale:this._locale,skipSpellCheck:c,queryTrigger:h,sessionTrackingEnabled:f}}).get().then(function(e){return e.json()})}},{key:"universalSearch",value:function(e,t){return new ne({endpoint:"/v2/accounts/me/answers/query",apiKey:this._apiKey,version:this._version,params:{input:e,experienceKey:this._experienceKey,location:t.geolocation?"".concat(t.geolocation.lat,",").concat(t.geolocation.lng):null,radius:t.geolocation?t.geolocation.radius:null,version:this._experienceVersion,locale:this._locale,skipSpellCheck:t.skipSpellCheck,queryTrigger:t.queryTrigger,sessionTrackingEnabled:t.sessionTrackingEnabled}}).get().then(function(e){return e.json()})}}]),e}(),re=function(){function e(n,i){t(this,e),this.eventType=n.toUpperCase(),i&&(this.label=i)}return i(e,[{key:"addOptions",value:function(e){return Object.assign(this,e),this}},{key:"toApiEvent",value:function(){return Object.assign({},this)}}]),e}(),oe=function(){function e(n,i,r,o){var a=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t(this,e),this._businessId=o,this._globalOptions=Object.assign({},s,{experienceKey:i}),this._baseUrl=ee,r&&(this._globalOptions.experienceVersion=r),n.globalStorage.on("update",N.QUERY_ID,function(e){return a.setQueryId(e)})}return i(e,[{key:"setQueryId",value:function(e){this._globalOptions.queryId=e}},{key:"report",value:function(e){if(!(e instanceof re))throw new E("Tried to send invalid analytics event",e);return e.addOptions(this._globalOptions),(new $).beacon("".concat(this._baseUrl,"/realtimeanalytics/data/answers/").concat(this._businessId),{data:e.toApiEvent()})}},{key:"setConversionTrackingEnabled",value:function(e){this._baseUrl=e?"https://realtimeanalytics.yext.com":ee}}]),e}(),ae=function(){function e(){t(this,e)}return i(e,[{key:"report",value:function(e){return!0}},{key:"setConversionTrackingEnabled",value:function(e){}}]),e}(),se=function(n){function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,r),(n=h(this,s(r).call(this)))._id=e,n._history=[],n._data=i,n.set(i),n}return a(r,G),i(r,[{key:"set",value:function(t){if(this.capturePrevious(),"object"!==e(t)||Array.isArray(t)||Object.keys(t).length!==Object.keys(this._data).length)return this._data=t,void this.emit("update",this._data);for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];if(this._data[r]!==t[r])return this._data=t,void this.emit("update",this._data)}}},{key:"capturePrevious",value:function(){void 0===this._history&&(this._history=[]),this._history.length+1>5&&this._history.shift(),this._history.push(JSON.stringify(this._data||{}))}},{key:"undo",value:function(){var e={};this._previous.length>0&&(e=JSON.parse(this._previous.pop())),this._data.set(e)}},{key:"raw",value:function(){return this._data}}]),r}(),le=function(){function e(){t(this,e),this._moduleDataContainer={},this._futureListeners={}}return i(e,[{key:"set",value:function(e,t){this._initDataContainer(e,t),this._moduleDataContainer[e].set(t)}},{key:"setAll",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var i=p(n[t],2),r=i[0],o=i[1];r!==N.QUERY&&this.set(r,o)}e[N.QUERY]&&this.set(N.QUERY,e[N.QUERY])}},{key:"_initDataContainer",value:function(e,t){if(null==e||"string"!=typeof e)throw new C("Invalid storage key provided",e,t);if(null==t)throw new C("No data provided",e,t);void 0===this._moduleDataContainer[e]&&(this._moduleDataContainer[e]=new se(e),this._applyFutureListeners(e))}},{key:"getState",value:function(e){return this._moduleDataContainer[e]?this._moduleDataContainer[e].raw():null}},{key:"getAll",value:function(e){for(var t=[],n=0,i=Object.keys(this._moduleDataContainer);n<i.length;n++){var r=i[n];r.startsWith(e)&&null!==this._moduleDataContainer[r].raw()&&t.push(this._moduleDataContainer[r].raw())}return t}},{key:"delete",value:function(e){delete this._moduleDataContainer[e]}},{key:"on",value:function(e,t,n){return void 0===this._moduleDataContainer[t]?(void 0===this._futureListeners[t]&&(this._futureListeners[t]=[]),void this._futureListeners[t].push({event:e,cb:n})):(this._moduleDataContainer[t].on(e,n),this)}},{key:"off",value:function(e,t,n){return void 0===this._moduleDataContainer[t]?(void 0!==this._futureListeners[t]&&this._futureListeners[t].pop(),this):(this._moduleDataContainer[t].off(e,n),this)}},{key:"_applyFutureListeners",value:function(e){var t=this._futureListeners[e];if(t){for(var n=0;n<t.length;n++){var i=t[n];this.on(i.event,e,i.cb)}delete this._futureListeners[e]}}}]),e}(),ue=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,e),this.moduleId=null,this.name=n.name||this.constructor.type,this._config=n,this._type=this.constructor.name,this._parentContainer=n.parentContainer||null,this._children=[],this._state=new Y(n.state),this.core=i.core||null,this.componentManager=i.componentManager||null,this.analyticsReporter=i.analyticsReporter||null,this._analyticsOptions=n.analyticsOptions||{},null===this._parentContainer){if("string"!=typeof n.container)throw new Error("Missing `container` option for component configuration. Must be of type `string`.");this._container=V.query(n.container)||null}else this._container=V.query(this._parentContainer,n.container),null===this._container&&(this._container=V.createEl("div",{class:n.container.substring(1,n.container.length)}),V.append(this._parentContainer,this._container));if(null===this._container)throw new Error("Cannot find container DOM node: "+n.container);this._className=n.class||"component",this._render=n.render||null,this._renderer=i.renderer||Q.Handlebars,this._template=n.template?this._renderer.compile(n.template):null,this._templateName=n.templateName||this.constructor.defaultTemplateName(n),this._isMounted=!1,this.transformData=n.transformData||this.transformData||function(){},this.onCreate=n.onCreateOverride||this.onCreate||function(){},this.onCreate=this.onCreate.bind(this),this.onMount=n.onMountOverride||this.onMount||function(){},this.onMount=this.onMount.bind(this),this.onUpdate=n.onUpdateOverride||this.onUpdate||function(){},this.onUpdate=this.onUpdate.bind(this),this.userOnCreate=n.onCreate||function(){},this.userOnMount=n.onMount||function(){},this.userOnUpdate=n.onUpdate||function(){}}return i(e,[{key:"init",value:function(e){var t=this;try{this.setState(e.data||e.state||{}),this.onCreate(),this.userOnCreate()}catch(e){throw new b("Error initializing component",this.constructor.type,e)}return this._state.on("update",function(){try{t.onUpdate(),t.userOnUpdate(),t.unMount(),t.mount()}catch(e){throw console.log(e),new b("Error updating component",t.constructor.type,e)}}),V.addClass(this._container,this._className),this}},{key:"setState",value:function(e){var t=Object.assign({},{_config:this._config},e);return this._state.set(t),this}},{key:"getState",value:function(e){return this._state.get(e)}},{key:"hasState",value:function(e){return this._state.has(e)}},{key:"transformData",value:function(e){return e}},{key:"addChild",value:function(e,t,n){var i=this.componentManager.create(t,Object.assign({name:e.name,parentContainer:this._container,data:e},n||{},{_parentOpts:this._config}));return this._children.push(i),i}},{key:"remove",value:function(){this._children.forEach(function(e){return e.remove()}),this.componentManager.remove(this)}},{key:"setRender",value:function(e){return this._render=e,this}},{key:"setRenderer",value:function(e){return this._renderer=Q[e],this}},{key:"setTemplate",value:function(e){this._template=this._renderer.compile(e)}},{key:"unMount",value:function(){if(!this._container)return this;this._children.forEach(function(e){e.unMount()}),V.empty(this._container),this._children.forEach(function(e){return e.remove()}),this._children=[],this.onUnMount()}},{key:"mount",value:function(){var e=this;if(!this._container)return this;if(!1===this.beforeMount())return this;V.append(this._container,this.render(this._state.asJSON()));var t=V.queryAll(this._container,"[data-component]:not([data-is-component-mounted])"),n=this.transformData(JSON.parse(JSON.stringify(this._state.get())));(t.forEach(function(t){return e._createSubcomponent(t,n)}),this._children.forEach(function(e){e.mount()}),this.analyticsReporter)&&V.queryAll(this._container,"[data-eventtype]:not([data-is-analytics-attached])").forEach(this._createAnalyticsHook.bind(this));return this._isMounted=!0,this.onMount(this),this.userOnMount(this),this}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._state.get();this.beforeRender(),e=this.transformData(JSON.parse(JSON.stringify(e)));var t="";if("function"==typeof this._render){if("string"!=typeof(t=this._render(e)))throw new Error("Render method must return HTML as type {string}")}else t=this._renderer.render({template:this._template,templateName:this._templateName},e);var n=V.create(t);return this.afterRender(),n.innerHTML}},{key:"_createSubcomponent",value:function(e,t){var n=this;e.dataset.isComponentMounted=!0;var i=e.dataset,r=i.component,a=i.prop,s=i.opts?JSON.parse(i.opts):{},l=t[a]||{};s=o({},s,{container:e}),Array.isArray(l)?(l.reverse(),l.forEach(function(e){n.addChild(e,r,s)})):this.addChild(l,r,s)}},{key:"_createAnalyticsHook",value:function(e){var t=this;e.dataset.isAnalyticsAttached=!0;var n=e.dataset,i=n.eventtype,r=n.eventlabel,o=n.eventoptions?JSON.parse(n.eventoptions):{};V.on(e,"click",function(e){var n=new re(i,r);n.addOptions(t._analyticsOptions),n.addOptions(o),t.analyticsReporter.report(n)})}},{key:"onCreate",value:function(e){}},{key:"onUpdate",value:function(e){}},{key:"beforeRender",value:function(e){}},{key:"afterRender",value:function(e){}},{key:"onMount",value:function(e){}},{key:"onUnMount",value:function(e){}},{key:"beforeMount",value:function(e){}},{key:"onDestroy",value:function(e){}}],[{key:"defaultTemplateName",value:function(e){return"default"}},{key:"areDuplicateNamesAllowed",value:function(){return!1}},{key:"type",get:function(){return"Component"}}]),e}(),ce=function(){function e(n){if(t(this,e),this.label=n.label,"string"!=typeof this.label)throw new b("label is a required configuration option for tab.","NavigationComponent");if(this.url=n.url,"string"!=typeof this.url)throw new b("url is a required configuration option for tab.","NavigationComponent");this.configId=n.configId||null,this.baseUrl=n.url,this.isFirst=n.isFirst||!1,this.isActive=n.isActive||!1}return i(e,null,[{key:"from",value:function(t){for(var n={},i=0;i<t.length;i++){var r=t[i];void 0===r.configId&&void 0===n[r.configId]&&(r.configId=r.url),n[r.configId]=new e(r)}return n}}]),e}(),he=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).dropdownLabel=i.dropdownLabel||"More",e.dropdownIcon=i.dropdownIcon||"kabob",e.static=i.static||!1,e.moduleId=N.NAVIGATION,e._tabs=ce.from(i.tabs),e._tabOrder=e.getDefaultTabOrder(i.tabs,e.getUrlParams()),e._navBreakpoints=[],e}return a(n,ue),i(n,[{key:"onCreate",value:function(){var e=this;this.static||(V.on(window,"resize",function(){e._debounceTimer&&clearTimeout(e._debounceTimer),e._debounceTimer=setTimeout(e.refitNav.bind(e),100)}),V.on(window,"click",this.checkOutsideClick.bind(this)))}},{key:"onMount",value:function(){this.static||(this.refitNav(),V.on(V.query(this._container,".yxt-Nav-more"),"click",this.toggleMoreDropdown.bind(this)))}},{key:"refitNav",value:function(){var e=V.query(this._container,".yxt-Nav-container"),t=V.query(this._container,".yxt-Nav-more"),n=V.query(this._container,".yxt-Nav-expanded"),i=V.query(this._container,".yxt-Nav-modal"),r=t.classList.contains("yxt-Nav-item--more")?e.offsetWidth:e.offsetWidth-t.offsetWidth,o=this._navBreakpoints.length,a=0,s=!0,l=!1,u=void 0;try{for(var c,h=n.children[Symbol.iterator]();!(s=(c=h.next()).done);s=!0){a+=c.value.offsetWidth}}catch(e){l=!0,u=e}finally{try{s||null==h.return||h.return()}finally{if(l)throw u}}if(a>r){this._navBreakpoints.push(a);var f=n.children.item(n.children.length-1);if(null===f)return;i.prepend(f),t.classList.contains("yxt-Nav-item--more")&&t.classList.remove("yxt-Nav-item--more")}else{if(o&&r>this._navBreakpoints[o-1]){var p=i.children.item(0);if(null===p)return;n.append(p),this._navBreakpoints.pop(),o--}0===i.children.length&&t.classList.add("yxt-Nav-item--more")}this.closeMoreDropdown(),(a>r||o>0&&r>this._navBreakpoints[o-1])&&this.refitNav()}},{key:"closeMoreDropdown",value:function(){V.query(this._container,".yxt-Nav-modal").classList.remove("is-active"),V.query(this._container,".yxt-Nav-more").setAttribute("aria-expanded",!1)}},{key:"openMoreDropdown",value:function(){V.query(this._container,".yxt-Nav-modal").classList.add("is-active"),V.query(this._container,".yxt-Nav-more").setAttribute("aria-expanded",!0)}},{key:"toggleMoreDropdown",value:function(){var e=V.query(this._container,".yxt-Nav-modal");e.classList.toggle("is-active"),V.query(this._container,".yxt-Nav-more").setAttribute("aria-expanded",e.classList.contains("is-active"))}},{key:"checkOutsideClick",value:function(e){e.target.closest(".yxt-Nav-container")||this.closeMoreDropdown()}},{key:"setState",value:function(e){void 0!==e.tabOrder&&(this._tabOrder=this.mergeTabOrder(e.tabOrder,this._tabOrder));for(var t=[],i=0;i<this._tabOrder.length;i++){var r=this._tabs[this._tabOrder[i]];void 0!==r&&(r.url=this.generateTabUrl(r.baseUrl,this.getUrlParams()),t.push(r))}return f(s(n.prototype),"setState",this).call(this,{tabs:t,dropdownLabel:this.dropdownLabel,dropdownIcon:this.dropdownIcon,static:this.static})}},{key:"getUrlParams",value:function(){return new te(window.location.search.substring(1))}},{key:"getDefaultTabOrder",value:function(e,t){var n=[];t&&t.has("tabOrder")&&(n=t.get("tabOrder").split(","));for(var i=0;i<e.length;i++){var r=e[i];void 0===r.configId&&(r.configId=r.url),n.includes(r.configId)||(r.isFirst?n.unshift(r.configId):n.push(r.configId))}return n}},{key:"mergeTabOrder",value:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.includes(i)||(this._tabs[i]&&this._tabs[i].isFirst?e.unshift(i):e.push(i))}return e}},{key:"generateTabUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new URLSearchParams;return t.set("tabOrder",this._tabOrder),e+"?"+t.toString()}}],[{key:"defaultTemplateName",value:function(e){return"navigation/navigation"}},{key:"type",get:function(){return"Navigation"}}]),n}(),fe=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r)))._barKey=i.barKey||null,e._verticalKey=i.verticalKey||null,e._formEl=i.formSelector||"form",e._inputEl=i.inputEl||".js-yext-query",e.title=i.title||"Answers Universal Search",e.labelText=i.labelText||"What are you interested in?",e.submitText=i.submitText||"Submit",e.submitIcon=i.submitIcon||null,e.promptHeader=i.promptHeader||null,e.autoFocus=!0===i.autoFocus,e.clearButton=void 0===i.clearButton||i.clearButton,e.autocompleteOnLoad=i.autocompleteOnLoad||!1,e.redirectUrl=i.redirectUrl||null,e._isTwin=i.isTwin,e.query=i.query||e.core.globalStorage.getState(N.QUERY),e.core.globalStorage.on("update",N.QUERY,function(t){e.query=t,e.setState(),navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(function(n){"granted"===n.state?navigator.geolocation.getCurrentPosition(function(n){e.core.globalStorage.set(N.GEOLOCATION,{lat:n.coords.latitude,lng:n.coords.longitude,radius:n.coords.accuracy}),e.search(t)}):e.search(t)}):setTimeout(function(){e.search(t)})}),e._searchCooldown=i.searchCooldown||300,e._promptForLocation=void 0===i.promptForLocation||Boolean(i.promptForLocation),e._showClearButton=e.clearButton&&e.query,e._allowEmptySearch=!!i.allowEmptySearch,e}return a(n,ue),i(n,[{key:"onCreate",value:function(){null==this.query||this.redirectUrl||this.core.setQuery(this.query),this._promptForLocation&&this.initLocationPrompt()}},{key:"onMount",value:function(){!0!==this.autoFocus||this.query||this.autocompleteOnLoad||this.focusInputElement(),this.initSearch(this._formEl),this.initAutoComplete(this._inputEl),this.clearButton&&this.initClearButton(),!0===this.autoFocus&&!this.query&&this.autocompleteOnLoad&&this.focusInputElement()}},{key:"remove",value:function(){this._autocomplete.remove(),f(s(n.prototype),"remove",this).call(this)}},{key:"initClearButton",value:function(){var e=this,t=V.query(this._container,".js-yxt-SearchBar-clear");this._showClearButton=this._showClearButton||this.query,t.classList.toggle("yxt-SearchBar--hidden",!this._showClearButton),V.on(t,"click",function(){e.query="",e._showClearButton=!1,t.classList.add("yxt-SearchBar--hidden"),e.setState({}),e.core.persistentStorage.set(N.QUERY,e.query),e.core.persistentStorage.delete(N.SEARCH_OFFSET),e.core.globalStorage.delete(N.SEARCH_OFFSET),e.core.setQuery(e.query),e.focusInputElement()}),V.on(this._inputEl,"input",function(n){var i=n.target.value;!e._showClearButton&&i.length>0?(e._showClearButton=!0,t.classList.remove("yxt-SearchBar--hidden")):e._showClearButton&&0===i.length&&(e._showClearButton=!1,t.classList.add("yxt-SearchBar--hidden"))})}},{key:"initLocationPrompt",value:function(){var e=this;this.core.globalStorage.on("update",N.INTENTS,function(t){t.nearMe&&null===e.core.globalStorage.getState(N.GEOLOCATION)&&navigator.geolocation.getCurrentPosition(function(t){e.core.globalStorage.set(N.GEOLOCATION,{lat:t.coords.latitude,lng:t.coords.longitude,radius:t.coords.accuracy}),e.search(e.query||"")})})}},{key:"initSearch",value:function(e){var t=this;this._formEl=e,this._container.classList.add("yxt-SearchBar-wrapper");var n=V.query(this._container,e);if(!n)throw new Error("Could not initialize SearchBar; Can not find {HTMLElement} `",this._formEl,"`.");V.on(n,"submit",function(e){e.preventDefault();var i=n.querySelector(t._inputEl),r=i.value,o=new te(window.location.search.substring(1));return o.set("query",r),"string"==typeof t.redirectUrl?(window.location.href=t.redirectUrl+"?"+o.toString(),!1):(i.blur(),t.core.persistentStorage.set(N.QUERY,r),t.core.persistentStorage.delete(N.SEARCH_OFFSET),t.core.globalStorage.delete(N.SEARCH_OFFSET),t.core.setQuery(r),t.search(r),!1)})}},{key:"initAutoComplete",value:function(e){var t=this;this._inputEl=e,this._autocomplete&&this._autocomplete.remove(),this._autocomplete=this.componentManager.create("AutoComplete",{parentContainer:this._container,name:"".concat(this.name,".autocomplete"),container:".yxt-SearchBar-autocomplete",barKey:this._barKey,autoFocus:this.autoFocus&&!this.autocompleteOnLoad,verticalKey:this._verticalKey,promptHeader:this.promptHeader,originalQuery:this.query,inputEl:e,onSubmit:function(){V.trigger(V.query(t._container,t._formEl),"submit")}})}},{key:"search",value:function(e){var t=this;if(!(this._throttled||!e&&!this._verticalKey||!e&&this._verticalKey&&!this._allowEmptySearch||this._isTwin)){if(this._throttled=!0,setTimeout(function(){t._throttled=!1},this._searchCooldown),this._verticalKey){var n=this.core.globalStorage.getAll(N.FILTER),i=n.length>1?P.and.apply(P,d(n)):n[0];return this.core.verticalSearch(this._verticalKey,{input:e,filter:JSON.stringify(i),offset:this.core.globalStorage.getState(N.SEARCH_OFFSET)||0})}var r=this.componentManager.getActiveComponent("Navigation");if(r){var o=r.getState("tabs"),a={};if(o&&Array.isArray(o))for(var s=0;s<o.length;s++){var l=new te(o[s].url.split("?")[1]);l.set("query",e);var u=o[s].baseUrl;l.toString().length>0&&(u+="?"+l.toString()),a[o[s].configId]=u}return this.core.search(e,a)}return this.core.search(e)}}},{key:"setState",value:function(e){return f(s(n.prototype),"setState",this).call(this,Object.assign({title:this.title,labelText:this.labelText,submitIcon:this.submitIcon,submitText:this.submitText,showClearButton:this._showClearButton,query:this.query||""},e))}},{key:"focusInputElement",value:function(){V.query(this._container,this._inputEl).focus()}}],[{key:"defaultTemplateName",value:function(){return"search/search"}},{key:"type",get:function(){return"SearchBar"}}]),n}(),pe=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,n),(e=h(this,s(n).call(this,i,r)))._barKey=i.barKey||i.inputKey||null,e._verticalKey=i.verticalKey||null,e._storeOnChange=i.storeOnChange||!1,e._formEl=i.formSelector||"form",e._inputEl=i.inputEl||".js-yext-query",e.title=i.title,e.searchText=i.searchText||"What are you interested in?",e.promptHeader=i.promptHeader||null,e.autoFocus=!0===i.autoFocus,e.redirectUrl=i.redirectUrl||null,e.query=i.query||e.core.globalStorage.getState("".concat(N.QUERY,".").concat(e.name))||"",e.core.globalStorage.on("update","".concat(N.QUERY,".").concat(e.name),function(t){e.query=t,e.search()}),e.filter=i.filter||e.core.globalStorage.getState("".concat(N.FILTER,".").concat(e.name))||"","string"==typeof e.filter)try{e.filter=JSON.parse(e.filter)}catch(e){}return e.searchParameters=e._buildSearchParameters(i.searchParameters),e.core.globalStorage.on("update","".concat(N.FILTER,".").concat(e.name),function(t){e.filter=t}),e}return a(n,ue),i(n,[{key:"onCreate",value:function(){this.query&&this.filter&&this.search()}},{key:"onMount",value:function(){this.initAutoComplete(this._inputEl),!0===this.autoFocus&&0===this.query.length&&V.query(this._container,this._inputEl).focus()}},{key:"initAutoComplete",value:function(e){var t=this;this._inputEl=e,this.componentManager.create("AutoComplete",{parentContainer:this._container,name:"".concat(this.name,".autocomplete"),isFilterSearch:!0,container:".yxt-SearchBar-autocomplete",promptHeader:this.promptHeader,originalQuery:this.query,originalFilter:this.filter,inputEl:e,verticalKey:this._verticalKey,barKey:this._barKey,searchParameters:this.searchParameters,onSubmit:function(e,n){var i=new te(window.location.search.substring(1));if(i.set("".concat(t.name,".query"),e),i.set("".concat(t.name,".filter"),n),"string"==typeof t.redirectUrl)return window.location.href=t.redirectUrl+"?"+i.toString(),!1;t.query=e,t.filter=P.fromResponse(n),t.core.persistentStorage.set("".concat(N.QUERY,".").concat(t.name),t.query),t.core.persistentStorage.set("".concat(N.FILTER,".").concat(t.name),t.filter),t.core.setFilter(t.name,t.filter),t.search()}})}},{key:"search",value:function(){if(!this._storeOnChange){var e=this.core.globalStorage.getAll(N.FILTER),t=e[0];e.length>1&&(t=P.and.apply(P,d(e)));var n=this.core.globalStorage.getState(N.QUERY)||"",i=this.core.globalStorage.getAll(N.FACET_FILTER)[0];this.core.persistentStorage.delete(N.SEARCH_OFFSET),this.core.globalStorage.delete(N.SEARCH_OFFSET),this.core.verticalSearch(this._verticalKey,{input:n,filter:JSON.stringify(t),facetFilter:JSON.stringify(i)})}}},{key:"setState",value:function(e){return f(s(n.prototype),"setState",this).call(this,Object.assign({title:this.title,searchText:this.searchText,query:this.query,filter:this.filter},e))}},{key:"_buildSearchParameters",value:function(e){var t={sectioned:!1,fields:[]};return void 0===e?t:(e.sectioned&&(t.sectioned=e.sectioned),t.fields=this._buildFields(e.fields),t)}},{key:"_buildFields",value:function(e){return void 0===e?[]:e.map(function(e){return o({fetchEntities:!1},e)})}}],[{key:"defaultTemplateName",value:function(){return"search/filtersearch"}},{key:"type",get:function(){return"FilterSearch"}}]),n}(),de=9,ge=13,ve=16,ye=17,me=18,_e=27,Se=37,be=39,ke=38,we=40,Ce=91,Ee=92,Le=93,Ie=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).isFilterSearch=i.isFilterSearch||!1,e._barKey=i.barKey||null,e._verticalKey=i.verticalKey||null,e._inputEl=i.inputEl||".js-yext-query",e._autocompleteEls=i.autoCompleteEls||".js-yext-autocomlete-option",e.moduleId="".concat(N.AUTOCOMPLETE,".").concat(e.name),e._originalQuery=i.originalQuery||"",e._sectionIndex=0,e._resultIndex=-1,e.promptHeader=i.promptHeader||null,e._autoFocus=i.autoFocus||!1,e._onSubmit=i.onSubmit||function(){},e._searchParameters=i.searchParameters||null,e}return a(n,ue),i(n,[{key:"setState",value:function(e){this.isQueryInputFocused()||(this._sectionIndex=0,this._resultIndex=-1,e={}),f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{hasResults:this.hasResults(e),sectionIndex:this._sectionIndex,resultIndex:this._resultIndex,promptHeader:0===this._originalQuery.length?this.promptHeader:null}))}},{key:"isQueryInputFocused",value:function(){return document.activeElement.className.includes(this._inputEl.substring(1))}},{key:"updateState",value:function(){this.setState(this._state.get())}},{key:"onCreate",value:function(){var e=this,t=V.query(this._parentContainer,this._inputEl);if(!t)throw new Error("Could not initialize AutoComplete. Can not find {HTMLElement} `",this._inputEl,"`.");V.attributes(t,{autocomplete:"off",autocorrect:"off",spellcheck:"false"}),V.on(document,"click",function(t){t.target.matches(".js-yxt-AutoComplete-wrapper *")||t.target.matches(e._inputEl)||e.close()}),V.on(t,"focus",function(){e.reset(),e.autoComplete(t.value)}),V.on(t,"keydown",function(n){e.handleNavigateResults(n.keyCode,n),e.handleSubmitResult(n.keyCode,t.value,n)}),this._autoFocus&&V.once(t,"click",function(){e.autoComplete(t.value)}),V.delegate(this._container,".js-yext-autocomplete-option","click",function(t,n){var i=n.dataset,r=i.short;e.updateQuery(r),e._onSubmit(r,i.filter),e.close()}),V.on(t,"keyup",function(n){e.handleTyping(n.keyCode,t.value,n)})}},{key:"close",value:function(){this.setState({}),this.reset()}},{key:"reset",value:function(){this._sectionIndex=0,this._resultIndex=-1,this.updateState()}},{key:"updateQuery",value:function(e){void 0===e&&(e=this._state.get("sections")[this._sectionIndex].results[this._resultIndex].shortValue);V.query(this._parentContainer,this._inputEl).value=e}},{key:"handleTyping",value:function(e,t,n){if(!([we,ke,ye,me,ve,Se,be,Ce,Ee,ge,de,Le].indexOf(e)>-1)){if(e===_e)return this.updateQuery(this._originalQuery),void this.close();this._originalQuery=t,this.reset(),this.autoComplete(t)}}},{key:"autoComplete",value:function(e){this.isFilterSearch?this.core.autoCompleteFilter(e,{namespace:this.name,verticalKey:this._verticalKey,barKey:this._barKey,searchParameters:this._searchParameters}):this._verticalKey||this._barKey?this.core.autoCompleteVertical(e,this.name,this._verticalKey,this._barKey):this.core.autoCompleteUniversal(e,this.name)}},{key:"hasResults",value:function(e){if(!e)return!1;var t=e.sections;if(!t)return!1;for(var n=0;n<t.length;n++){var i=t[n];if(i){var r=i.results;if(r&&r.length>0)return!0}}return!1}},{key:"handleNavigateResults",value:function(e,t){var n=this._state.get("sections");if(!(void 0===n||n.length<=0))if(e!==de){var i=n[this._sectionIndex].results;if(e===ke)return t.preventDefault(),this._resultIndex<=0?this._sectionIndex>0?(this._sectionIndex--,this._resultIndex=n[this._sectionIndex].results.length-1,this.updateQuery(),void this.updateState()):(this.updateQuery(this._originalQuery),void this.reset()):(this._resultIndex--,this.updateState(),void this.updateQuery());if(e===we){if(t.preventDefault(),this._resultIndex>=i.length-1)return this._sectionIndex<n.length-1&&(this._sectionIndex++,this._resultIndex=0),this.updateQuery(),void this.updateState();this._resultIndex++,this.updateQuery(),this.updateState()}}else this.close()}},{key:"handleSubmitResult",value:function(e,t,n){var i=this._state.get("sections");if(void 0===i||i.length<=0)this.isFilterSearch&&this.autoComplete(t);else if(e===ge){if(n.preventDefault(),this.isFilterSearch&&-1===this._resultIndex)return;var r="";this._sectionIndex>=0&&this._resultIndex>=0&&(r=JSON.stringify(i[this._sectionIndex].results[this._resultIndex].filter)),this.updateQuery(t),this._originalQuery=t,this._onSubmit(t,r),this.close()}}}],[{key:"defaultTemplateName",value:function(e){return"search/autocomplete"}},{key:"type",get:function(){return"AutoComplete"}}]),n}(),Oe=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).moduleId=N.SPELL_CHECK,e}return a(n,ue),i(n,[{key:"onCreate",value:function(){this.core.persistentStorage.delete("skipSpellCheck",!0),this.core.persistentStorage.delete("queryTrigger",!0)}},{key:"setState",value:function(e,t){return f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{shouldShow:void 0!==e.correctedQuery,correctedQueryUrl:this._buildRedirectQueryUrl(e.correctedQuery,e.type),helpText:this._getHelpText(e.type)},t))}},{key:"_buildRedirectQueryUrl",value:function(e,t){if(void 0===e)return"";var n=new te(window.location.search.substring(1));return n.set("query",e.value),n.set("skipSpellCheck",!0),n.set("queryTrigger",t.toLowerCase()),"?"+n.toString()}},{key:"_getHelpText",value:function(e){switch(e){case"SUGGEST":return"Did you mean:";default:return""}}}],[{key:"defaultTemplateName",value:function(){return"search/spellcheck"}},{key:"type",get:function(){return"SpellCheck"}}]),n}(),Te=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).moduleId=N.LOCATION_BIAS,e._verticalKey=i.verticalKey||e.core.globalStorage.getState(N.SEARCH_CONFIG).verticalKey||null,e._updateLocationEl=i.updateLocationEl||".js-locationBias-update-location",e._locationDisplayName="",e._accuracy="",e._allowUpdate=!0,e}return a(n,ue),i(n,[{key:"onMount",value:function(){var e=this;this._allowUpdate&&(this._disableLocationUpdateIfGeolocationDenied(),V.on(this._updateLocationEl,"click",function(t){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(function(t){e.core.globalStorage.set(N.GEOLOCATION,{lat:t.coords.latitude,lng:t.coords.longitude,radius:t.coords.accuracy}),e._doSearch()},function(t){1===t.code&&e._disableLocationUpdate()})}))}},{key:"setState",value:function(e,t){return this._locationDisplayName=e.locationDisplayName,this._accuracy=e.accuracy,f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{locationDisplayName:this._getLocationDisplayName(e),accuracyText:this._getAccuracyHelpText(e.accuracy),isPreciseLocation:"DEVICE"===e.accuracy&&this._allowUpdate,isUnknownLocation:"UNKNOWN"===e.accuracy,shouldShow:void 0!==e.accuracy,allowUpdate:this._allowUpdate},t))}},{key:"_getLocationDisplayName",value:function(e){return"UNKNOWN"===e.accuracy?"Unknown Location":e.locationDisplayName}},{key:"_getAccuracyHelpText",value:function(e){switch(e){case"IP":return"based on your internet address";case"DEVICE":return"based on your device";default:return""}}},{key:"_doSearch",value:function(){var e=this.core.globalStorage.getState(N.QUERY);if(this._verticalKey){var t=this.core.globalStorage.getAll(N.FILTER),n=t.length>1?P.and.apply(P,d(t)):t[0],i=this.core.globalStorage.getAll(N.FACET_FILTER)[0];this.core.verticalSearch(this._verticalKey,{input:e,filter:JSON.stringify(n),offset:this.core.globalStorage.getState(N.SEARCH_OFFSET)||0,facetFilter:JSON.stringify(i)})}else this.core.search(e)}},{key:"_disableLocationUpdateIfGeolocationDenied",value:function(){var e=this;"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(function(t){"denied"===t.state&&e._disableLocationUpdate()})}},{key:"_disableLocationUpdate",value:function(){this.core.globalStorage.delete(N.GEOLOCATION),this._allowUpdate=!1,this.setState({locationDisplayName:this._locationDisplayName,accuracy:this._accuracy})}}],[{key:"defaultTemplateName",value:function(){return"search/locationbias"}},{key:"type",get:function(){return"LocationBias"}}]),n}(),xe=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),Object.assign(this,n),Object.freeze(this)}return i(e,null,[{key:"fromFilters",value:function(t){var n={};t.forEach(function(e){n[e]=[]});for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return r.flatMap(function(e){return e.$or||e}).forEach(function(e){var t=Object.keys(e)[0];n[t]||(n[t]=[]),n[t].push(e)}),new e(n)}}]),e}(),Ae=function(){function e(n){t(this,e),this.title=n.title||"Filters",this.showCount=void 0===n.showCount||n.showCount,this.searchOnChange=n.searchOnChange||!1,this.resetFilter=n.resetFacet||!1,this.resetFilterLabel=n.resetFacetLabel||"reset",this.resetFilters=void 0===n.resetFacets||n.resetFacets,this.resetFiltersLabel=n.resetFacetsLabel||"reset all",this.showMoreLimit=n.showMoreLimit||5,this.showMoreLabel=n.showMoreLabel||"show more",this.showLessLabel=n.showLessLabel||"show less",this.showMore=void 0===n.showMore||n.showMore,this.expand=void 0===n.expand||n.expand,this.showNumberApplied=void 0===n.showNumberApplied||n.showNumberApplied,this.applyLabel=n.applyLabel||"apply",this.applyButtonSelector=n.applyButtonSelector||".js-yext-filterbox-apply",this.filterConfigs=n.filters.filter(function(e){return 0!==e.options.length}),this.isDynamic=n.isDynamic||!1,this.validate()}return i(e,[{key:"validate",value:function(){}}]),e}(),Re=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,n),(e=h(this,s(n).call(this,i,r))).config=new Ae(i),!(i.filters&&i.filters instanceof Array))throw new b("FilterBox requires filters to be provided as an array","FilterBox");return e._verticalKey=i.verticalKey||null,e._filterComponents=[],e._filters=[],e.config.showCount||e.config.filterConfigs.forEach(function(e){e.options.forEach(function(e){e.countLabel=null})}),e}return a(n,ue),i(n,[{key:"setState",value:function(e){f(s(n.prototype),"setState",this).call(this,Object.assign({},e,this.config,{showReset:this.config.resetFilters,resetLabel:this.config.resetFiltersLabel,showApplyButton:!this.config.searchOnChange}))}},{key:"onMount",value:function(){var e=this;this._filterComponents.length&&(this._filterComponents.forEach(function(e){return e.remove()}),this._filterComponents=[],this._filters=[]);for(var t=function(t){var n=e.config.filterConfigs[t],i=e.componentManager.create(n.type,Object.assign({},n,e.config,{parentContainer:e._container,name:"".concat(e.name,".filter").concat(t),storeOnChange:!1,container:".js-yext-filterbox-filter".concat(t),showReset:e.config.resetFilter,resetLabel:e.config.resetFilterLabel,showExpand:e.config.expand,onChange:function(n){e.onFilterChange(t,n)}}));i.mount(),e._filterComponents.push(i),e._filters[t]=i.getFilter(),e._saveFiltersToStorage()},n=0;n<this.config.filterConfigs.length;n++)t(n);if(!this.config.searchOnChange){var i=V.query(this._container,this.config.applyButtonSelector);i&&V.on(i,"click",function(){e._saveFiltersToStorage(),e._search()})}this.config.resetFilters&&V.on(V.query(this._container,".js-yxt-FilterBox-reset"),"click",this.resetFilters.bind(this))}},{key:"resetFilters",value:function(){this._filterComponents.forEach(function(e){return e.clearOptions()})}},{key:"onFilterChange",value:function(e,t){this._filters[e]=t,this.config.searchOnChange&&(this._saveFiltersToStorage(),this._search())}},{key:"remove",value:function(){this._filterComponents.forEach(function(e){return e.remove()}),f(s(n.prototype),"remove",this).call(this)}},{key:"_saveFiltersToStorage",value:function(){var e=this._filters.filter(function(e){return null!=e&&Object.keys(e).length>0});if(this.config.isDynamic){var t=this.config.filterConfigs.map(function(e){return e.fieldId}),n=xe.fromFilters.apply(xe,[t].concat(d(e)));this.core.setFacetFilter(this.name,n||{})}else{var i=e.length>1?P.and.apply(P,d(e)):e[0];this.core.setFilter(this.name,i||{})}}},{key:"_search",value:function(){var e=this.core.globalStorage.getAll(N.FILTER),t=e.length>1?P.and.apply(P,d(e)):e[0],n=this.core.globalStorage.getState(N.QUERY),i=this.core.globalStorage.getAll(N.FACET_FILTER)[0];this.core.persistentStorage.delete(N.SEARCH_OFFSET),this.core.globalStorage.delete(N.SEARCH_OFFSET),this.core.verticalSearch(this._verticalKey,{input:n,filter:JSON.stringify(t),facetFilter:JSON.stringify(i)})}}],[{key:"defaultTemplateName",value:function(){return"filters/filterbox"}},{key:"type",get:function(){return"FilterBox"}}]),n}(),Fe=["singleoption","multioption"],Ne=function(){function e(n){if(t(this,e),this.control=n.control,this.options=n.options,this.label=n.label||"Filters",this.onChange=n.onChange||function(){},this.storeOnChange=n.storeOnChange||!1,this.showReset=n.showReset||!1,this.showReset=this.showReset&this.options.length>0,this.resetLabel=n.resetLabel||"reset",this.showMoreLimit=n.showMoreLimit||5,this.showMoreLabel=n.showMoreLabel||"show more",this.showLessLabel=n.showLessLabel||"show less",this.showMore=void 0===n.showMore||n.showMore,this.showMore=this.showMore&&this.options.length>this.showMoreLimit,this.showExpand=void 0===n.showExpand||n.showExpand,this.showNumberApplied=void 0===n.showNumberApplied||n.showNumberApplied,this.optionSelector=n.optionSelector||".js-yext-filter-option",this.validate(),"string"==typeof n.previousOptions)try{n.previousOptions=JSON.parse(n.previousOptions)}catch(e){n.previousOptions=[]}var i=n.previousOptions||[];this.options=this.setDefaultSelectedValues(this.options,i)}return i(e,[{key:"setDefaultSelectedValues",value:function(e,t){return e.map(function(e){return o({},e,{selected:t.length?t.includes(e.label):e.selected})})}},{key:"getSelectedCount",value:function(){return this.options.reduce(function(e,t){return t.selected?e+1:e},0)}},{key:"validate",value:function(){if(!this.control||!Fe.includes(this.control))throw new b('FilterOptions requires a valid "control" to be provided',"FilterOptions");if(!this.options)throw new b("FilterOptions component requires options to be provided","FilterOptions")}}]),e}(),Me=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,n);var a=(e=h(this,s(n).call(this,i,r))).core.globalStorage.getState(e.name);e.core.globalStorage.delete(e.name),e.config=new Ne(o({previousOptions:a},i));var l=e.config.getSelectedCount();return e.expanded=!e.config.showExpand||l>0,e.allShown=!1,e}return a(n,ue),i(n,[{key:"setState",value:function(e){var t=this.config.options;this.config.showMore&&!this.allShown&&(t=this.config.options.slice(0,this.config.showMoreLimit));var i=this.config.getSelectedCount();f(s(n.prototype),"setState",this).call(this,Object.assign({},e,o({name:this.name.toLowerCase()},this.config,{showReset:this.config.showReset&&i>0,expanded:this.expanded,allShown:this.allShown,selectedCount:i,isSingleOption:"singleoption"===this.config.control,options:t})))}},{key:"onMount",value:function(){var e=this;V.delegate(V.query(this._container,".yxt-FilterOptions-options"),this.config.optionSelector,"click",function(t){e._updateOption(parseInt(t.target.dataset.index),t.target.checked)});var t=this.config.getSelectedCount();if(this.config.showReset&&t>0&&V.on(V.query(this._container,".yxt-FilterOptions-reset"),"click",this.clearOptions.bind(this)),this.config.showMore&&V.on(V.query(this._container,".yxt-FilterOptions-showToggle"),"click",function(){e.allShown=!e.allShown,e.setState()}),this.config.showExpand){var n=V.query(this._container,".yxt-FilterOptions-clickableLegend");V.on(n,"mousedown",function(t){0===t.button&&(e.expanded=!e.expanded,e.setState())}),V.on(n,"keydown",function(t){" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),e.expanded=!e.expanded,e.setState())})}}},{key:"clearOptions",value:function(){this.config.options=this.config.options.map(function(e){return Object.assign({},e,{selected:!1})}),this.updateListeners(),this.setState()}},{key:"updateListeners",value:function(){var e=this._buildFilter();this.config.storeOnChange&&this.core.setFilter(this.name,e),this.config.onChange(e)}},{key:"_updateOption",value:function(e,t){"singleoption"===this.config.control&&(this.config.options=this.config.options.map(function(e){return Object.assign({},e,{selected:!1})})),this.config.options[e]=Object.assign({},this.config.options[e],{selected:t}),this.updateListeners(),this.setState()}},{key:"getFilter",value:function(){return this._buildFilter()}},{key:"clear",value:function(){V.queryAll(this._container,this.config.optionSelector).forEach(function(e){return e.setAttribute("checked","false")}),this._applyFilter()}},{key:"_buildFilter",value:function(){var e=this.config.options.filter(function(e){return e.selected}).map(function(e){return e.filter?e.filter:P.equal(e.field,e.value)});return this.core.persistentStorage.set(this.name,this.config.options.filter(function(e){return e.selected}).map(function(e){return e.label})),e.length>0?P.group.apply(P,d(e)):{}}}],[{key:"defaultTemplateName",value:function(e){return"controls/filteroptions"}},{key:"type",get:function(){return"FilterOptions"}}]),n}(),qe=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,n),(e=h(this,s(n).call(this,i,r)))._field=i.field,e._onChange=i.onChange||function(){},e._storeOnChange=i.storeOnChange||!1;var o=e.core.globalStorage.getState("".concat(e.name,".min"));if("string"==typeof o)try{o=Number.parseInt(o)}catch(e){}var a=e.core.globalStorage.getState("".concat(e.name,".max"));if("string"==typeof o)try{a=Number.parseInt(a)}catch(e){}return e._range={min:o||i.initialMin||0,max:a||i.initialMax||10},e._title=i.title,e._minLabel=i.minLabel||null,e._maxLabel=i.maxLabel||null,e._templateName="controls/range",e}return a(n,ue),i(n,[{key:"setState",value:function(e){f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{name:this.name,title:this._title,minLabel:this._minLabel,maxLabel:this._maxLabel,minValue:this._range.min,maxValue:this._range.max}))}},{key:"onCreate",value:function(){var e=this;V.delegate(this._container,".js-yext-range","change",function(t){e._updateRange(t.target.dataset.key,Number.parseInt(t.target.value))})}},{key:"setMin",value:function(e){this._updateRange("min",e)}},{key:"setMax",value:function(e){this._updateRange("max",e)}},{key:"getFilter",value:function(){return this._buildFilter()}},{key:"_updateRange",value:function(e,t){this._range=Object.assign({},this._range,r({},e,t)),this.setState();var n=this._buildFilter();this._storeOnChange&&this.core.setFilter(this.name,n),this.core.persistentStorage.set("".concat(this.name,".min"),this._range.min),this.core.persistentStorage.set("".concat(this.name,".max"),this._range.max),this._onChange(n)}},{key:"_buildFilter",value:function(){return P.inclusiveRange(this._field,this._range.min,this._range.max)}}],[{key:"type",get:function(){return"RangeFilter"}}]),n}(),Ue=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,n),(e=h(this,s(n).call(this,i,r)))._field=i.field,e._title=i.title,e._minLabel=i.minLabel||null,e._maxLabel=i.maxLabel||null,e._onChange=i.onChange||function(){},e._storeOnChange=i.storeOnChange||!1,e._isExclusive=i.isExclusive,e._templateName="controls/date";var o=new Date,a="".concat(o.getFullYear(),"-").concat("".concat(o.getMonth()+1).padStart(2,"0"),"-").concat("".concat(o.getDate()).padStart(2,"0")),l=e.core.globalStorage.getState("".concat(e.name,".min")),u=e.core.globalStorage.getState("".concat(e.name,".max"));return e._date={min:l||i.initialMin||a,max:u||i.initialMax||a},e}return a(n,ue),i(n,[{key:"setState",value:function(e){f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{name:this.name,title:this._title,minLabel:this._minLabel,maxLabel:this._maxLabel,dateMin:this._date.min,dateMax:this._date.max}))}},{key:"onCreate",value:function(){var e=this;V.delegate(this._container,".js-yext-date","change",function(t){e._updateRange(t.target.dataset.key,t.target.value)})}},{key:"setMin",value:function(e){this._updateRange("min",e)}},{key:"setMax",value:function(e){this._updateRange("max",e)}},{key:"getFilter",value:function(){return this._buildFilter()}},{key:"_updateRange",value:function(e,t){this._date=Object.assign({},this._date,r({},e,t)),this.setState();var n=this._buildFilter();this._storeOnChange&&this.core.setFilter(this.name,n),this.core.persistentStorage.set("".concat(this.name,".min"),this._date.min),this.core.persistentStorage.set("".concat(this.name,".max"),this._date.max),this._onChange(n)}},{key:"_buildFilter",value:function(){return""===this._date.min||""===this._date.max?{}:this._isExclusive?P.exclusiveRange(this._field,this._date.min,this._date.max):P.inclusiveRange(this._field,this._date.min,this._date.max)}}],[{key:"type",get:function(){return"DateRangeFilter"}}]),n}(),Ke=function(){function e(n){t(this,e),this.title=n.title||"Filters",this.showCount=void 0===n.showCount||n.showCount,this.searchOnChange=n.searchOnChange||!1,this.resetFacet=n.resetFacet||!1,this.resetFacetLabel=n.resetFacetLabel||"reset",this.resetFacets=void 0===n.resetFacets||n.resetFacets,this.resetFacetsLabel=n.resetFacetsLabel||"reset all",this.showMoreLimit=n.showMoreLimit||5,this.showMoreLabel=n.showMoreLabel||"show more",this.showLessLabel=n.showLessLabel||"show less",this.showMore=void 0===n.showMore||n.showMore,this.expand=void 0===n.expand||n.expand,this.showNumberApplied=void 0===n.showNumberApplied||n.showNumberApplied,this.applyLabel=n.applyLabel||"apply",this.fieldControls=n.fieldControls||{},this.applyButtonSelector=n.applyButtonSelector||null,this.validate()}return i(e,[{key:"validate",value:function(){}}]),e}(),De=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).config=new Ke(i),e._verticalKey=i.verticalKey,e._applyButtonSelector=i.applyButtonSelector||null,e.moduleId=N.DYNAMIC_FILTERS,e._filterbox=null,e}return a(n,ue),i(n,[{key:"remove",value:function(){this._filterbox&&this._filterbox.remove(),f(s(n.prototype),"remove",this).call(this)}},{key:"onMount",value:function(){var e=this;this.core.enableDynamicFilters(),this._filterbox&&this._filterbox.remove();var t=this._state.get().filters;t&&(t=t.map(function(t){return Object.assign({},t,{type:"FilterOptions",control:e.config.fieldControls[t.fieldId]||"multioption"})}),this._filterbox=this.componentManager.create("FilterBox",Object.assign({},this.config,{parentContainer:this._container,name:"".concat(this.name,".filterbox"),container:".js-yxt-Facets",verticalKey:this._verticalKey,resetFilter:this.config.resetFacet,resetFilters:this.config.resetFacets,resetFilterLabel:this.config.resetFacetLabel,resetFiltersLabel:this.config.resetFacetsLabel,isDynamic:!0,filters:t})),this._filterbox.mount())}}],[{key:"defaultTemplateName",value:function(){return"filters/facets"}},{key:"type",get:function(){return"Facets"}}]),n}(),Pe={radius:50,verticalKey:null,searchOnChange:!1,title:"Location",label:"Location",geoButtonIcon:"",geoButtonText:"Use My Location",enabledText:"Current Location",loadingText:"Finding Your Location...",errorText:"Could Not Find Your Location",buttonSelector:".js-yxt-GeoLocationFilter-button",inputSelector:".js-yxt-GeoLocationFilter-input"},He=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,n),(e=h(this,s(n).call(this,o({},Pe,{},i),r))).query=e.core.globalStorage.getState("".concat(N.QUERY,".").concat(e.name))||"",e.core.globalStorage.on("update","".concat(N.QUERY,".").concat(e.name),function(t){e.query=t,e.setState()}),e.filter=e.core.globalStorage.getState("".concat(N.FILTER,".").concat(e.name))||{},"string"==typeof e.filter)try{e.filter=JSON.parse(e.filter)}catch(e){}return e.core.globalStorage.on("update","".concat(N.FILTER,".").concat(e.name),function(t){e.filter=t}),e}return a(n,ue),i(n,[{key:"setState",value:function(e){var t="";this._enabled&&(t=this._config.enabledText),e.geoLoading&&(t=this._config.loadingText),e.geoError&&(t=this._config.errorText),f(s(n.prototype),"setState",this).call(this,o({},e,{title:this._config.title,geoEnabled:this._enabled,query:this.query,labelText:this._config.label,enabledText:this._config.enabledText,loadingText:this._config.loadingText,errorText:this._config.errorText,geoButtonIcon:this._config.geoButtonIcon,geoValue:this._enabled||e.geoLoading||e.geoError?"":this.query,geoPlaceholder:t,geoButtonText:this._config.geoButtonText}))}},{key:"onMount",value:function(){var e=this;this._autocomplete&&this._autocomplete.remove(),this._initAutoComplete(this._config.inputSelector),V.on(this._config.buttonSelector,"click",function(){return e._toggleGeoFilter()})}},{key:"_initAutoComplete",value:function(e){var t=this;this._autocomplete&&this._autocomplete.remove(),this._autocomplete=this.componentManager.create("AutoComplete",{parentContainer:this._container,name:"".concat(this.name,".autocomplete"),isFilterSearch:!0,container:".js-yxt-GeoLocationFilter-autocomplete",originalQuery:this.query,originalFilter:this.filter,inputEl:e,verticalKey:this._verticalKey,onSubmit:function(e,n){t.query=e,t.filter=P.fromResponse(n),t._saveDataToStorage(e,t.filter),t._enabled=!1}})}},{key:"_toggleGeoFilter",value:function(){var e=this;navigator.geolocation?this._enabled||(this.setState({geoLoading:!0}),navigator.geolocation.getCurrentPosition(function(t){var n=e._buildFilter(t);e._saveDataToStorage("",n,t),e._enabled=!0,e.setState({}),e.core.persistentStorage.delete("".concat(N.QUERY,".").concat(e.name)),e.core.persistentStorage.delete("".concat(N.FILTER,".").concat(e.name))},function(){return e.setState({geoError:!0})})):this.setState({geoError:!0})}},{key:"_saveDataToStorage",value:function(e,t,n){if(this.core.persistentStorage.set("".concat(N.QUERY,".").concat(this.name),e),this.core.persistentStorage.set("".concat(N.FILTER,".").concat(this.name),t),this.core.setFilter(this.name,t),n&&this.core.globalStorage.set(N.GEOLOCATION,{lat:n.coords.latitude,lng:n.coords.longitude,radius:n.coords.accuracy}),this._config.searchOnChange){var i=this.core.globalStorage.getAll(N.FILTER),r=i[0];i.length>1&&(r=P.and.apply(P,d(i)));var o=this.core.globalStorage.getState(N.QUERY)||"",a=this.core.globalStorage.getAll(N.FACET_FILTER)[0];this.core.persistentStorage.delete(N.SEARCH_OFFSET),this.core.globalStorage.delete(N.SEARCH_OFFSET),this.core.verticalSearch(this._config.verticalKey,{input:o,filter:JSON.stringify(r),facetFilter:JSON.stringify(a)})}}},{key:"_buildFilter",value:function(e){var t=e.coords,n=t.latitude,i=t.longitude,r=t.accuracy,o=Math.max(r,1609.344*this._config.radius);return P.position(n,i,o)}}],[{key:"defaultTemplateName",value:function(){return"controls/geolocation"}},{key:"type",get:function(){return"GeoLocationFilter"}}]),n}(),je="THUMBS_UP",Ve="THUMBS_DOWN",Be=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).moduleId=N.DIRECT_ANSWER,e._formEl=i.formEl||".js-directAnswer-feedback-form",e._thumbsUpSelector=i.thumbsUpSelector||".js-directAnswer-thumbUp",e._thumbsDownSelector=i.thumbsDownSelector||".js-directAnswer-thumbDown",e._viewDetailsText=i.viewDetailsText||"View Details",e}return a(n,ue),i(n,[{key:"beforeMount",value:function(){return!!this.hasState("answer")}},{key:"onMount",value:function(){var e=this;if(!0===this.getState("feedbackSubmitted"))return this;V.on(this._formEl,"submit",function(t){var n=t.target,i="true"===V.query(n,"input:checked").value;e.reportQuality(i),e.updateState({feedbackSubmitted:!0})}),V.on(this._thumbsUpSelector,"click",function(){V.trigger(e._formEl,"submit")}),V.on(this._thumbsDownSelector,"click",function(){V.trigger(e._formEl,"submit")})}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.getState(),e);this.setState(t)}},{key:"setState",value:function(e){return f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{eventOptions:this.eventOptions(e),viewDetailsText:this._viewDetailsText}))}},{key:"eventOptions",value:function(e){return e&&0!==Object.keys(e).length?JSON.stringify({verticalConfigId:e.relatedItem.verticalConfigId,searcher:"UNIVERSAL",entityId:e.relatedItem.data.id,ctaLabel:this._viewDetailsText.toUpperCase().replace(" ","_")}):e}},{key:"reportQuality",value:function(e){var t=new re(!0===e?je:Ve).addOptions({directAnswer:!0});this.analyticsReporter.report(t)}}],[{key:"defaultTemplateName",value:function(e){return"results/directanswer"}},{key:"type",get:function(){return"DirectAnswer"}}]),n}(),ze=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r)))._verticalConfigId=i.verticalConfigId,e._isUniversal=i.isUniversal||!1,e}return a(n,ue),i(n,[{key:"eventOptions",value:function(e,t){var n={verticalConfigId:this._verticalConfigId,searcher:this._isUniversal?"UNIVERSAL":"VERTICAL"};return e?n.entityId=e:n.url=t,JSON.stringify(n)}},{key:"setState",value:function(e){return f(s(n.prototype),"setState",this).call(this,Object.assign(e,{eventOptions:this.eventOptions(e.id,e.link)}))}}],[{key:"defaultTemplateName",value:function(e){return"results/resultsitem"}},{key:"areDuplicateNamesAllowed",value:function(){return!0}},{key:"type",get:function(){return"ResultsItemComponent"}}]),n}(),Qe=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),h(this,s(n).call(this,e,i))}return a(n,ze),i(n,null,[{key:"defaultTemplateName",value:function(e){return"results/locationresultsitem"}},{key:"areDuplicateNamesAllowed",value:function(){return!0}},{key:"type",get:function(){return"LocationResultsItemComponent"}}]),n}(),Ge=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),h(this,s(n).call(this,e,i))}return a(n,ze),i(n,null,[{key:"defaultTemplateName",value:function(e){return"results/eventresultsitem"}},{key:"areDuplicateNamesAllowed",value:function(){return!0}},{key:"type",get:function(){return"EventResultsItemComponent"}}]),n}(),Ye=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),h(this,s(n).call(this,e,i))}return a(n,ze),i(n,null,[{key:"defaultTemplateName",value:function(e){return"results/peopleresultsitem"}},{key:"areDuplicateNamesAllowed",value:function(){return!0}},{key:"type",get:function(){return"PeopleResultsItemComponent"}}]),n}(),Je=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this._apiKey=n.apiKey,this._zoom=n.zoom||14,this._defaultPosition=n.defaultPosition||{lat:37.0902,lng:-95.7129},this._showEmptyMap=n.showEmptyMap||!1,this._map=null,this._isLoaded=!1,this._onPinClick=n.onPinClick||null,this._onLoaded=n.onLoaded||function(){},this._pinConfig="function"==typeof n.pin?n.pin:Object.assign(e.DEFAULT_PIN_CONFIG,n.pin),this._collapsePins=n.collapsePins||!1}return i(e,[{key:"onLoaded",value:function(e){"function"==typeof e&&(this._onLoaded=e,this.isLoaded()&&this._onLoaded())}},{key:"isLoaded",value:function(){return this._isLoaded}},{key:"loadJS",value:function(){throw new Error("Unimplemented Method: loadJS")}},{key:"init",value:function(e){throw new Error("Unimplemented Method: init")}},{key:"_collapseMarkers",value:function(e){var t={};e.forEach(function(e){t["".concat(e.latitude).concat(e.longitude)]?t["".concat(e.latitude).concat(e.longitude)].push(e):t["".concat(e.latitude).concat(e.longitude)]=[e]});for(var n=[],i=0,r=Object.entries(t);i<r.length;i++){var o=p(r[i],2)[1];if(o.length>1){var a={item:o.map(function(e){return e.item}),label:o.length,latitude:o[0].latitude,longitude:o[0].longitude};n.push(a)}else n.push(o[0])}return n}}],[{key:"DEFAULT_PIN_CONFIG",get:function(){return{icon:{anchor:null,svg:null,url:null,scaledSize:null},labelType:"numeric"}}}]),e}(),We=function(e){function n(e){var i;if(t(this,n),(i=h(this,s(n).call(this,e)))._zoomOffset=1,i._zoom+=i._zoomOffset,i._clientId=e.clientId,i._signature=e.signature,!i.hasValidClientCredentials()&&!i._apiKey)throw new Error("GoogleMapsProvider: Missing `apiKey` or {`clientId`, `signature`}");return i}return a(n,Je),i(n,[{key:"loadJS",value:function(e){var t=this;if(V.query("#yext-map-js"))return this._isLoaded=!0,void("function"==typeof e&&e());var n=V.createEl("script",{id:"yext-map-js",onload:function(){t._isLoaded=!0,t._onLoaded()},async:!0,src:"https://maps.googleapis.com/maps/api/js?".concat(this.generateCredentials())});V.append("body",n)}},{key:"generateCredentials",value:function(){return this.hasValidClientCredentials()?"client=".concat(this._clientId):"key=".concat(this._apiKey)}},{key:"hasValidClientCredentials",value:function(){return this._clientId}},{key:"init",value:function(e,t){var n=this;if((!t||t.mapMarkers.length<=0)&&!this._showEmptyMap)return this._map=null,this;setTimeout(function(){var i=V.query(e);n.map=new google.maps.Map(i,{zoom:n._zoom,center:n.getCenterMarker(t)}),t&&t.mapMarkers.length&&function(){for(var e=n._collapsePins?n._collapseMarkers(t.mapMarkers):t.mapMarkers,i=$e.from(e,n._pinConfig,n.map),r=new google.maps.LatLngBounds,o=function(t){var o=new google.maps.Marker(i[t]);n._onPinClick&&o.addListener("click",function(){return n._onPinClick(e[t].item)}),r.extend(o.position)},a=0;a<i.length;a++)o(a);i.length>=2&&n.map.fitBounds(r)}()},100)}},{key:"getCenterMarker",value:function(e){return e&&e.mapCenter&&e.mapCenter.longitude&&e.mapCenter.latitude?{lng:e.mapCenter.longitude,lat:e.mapCenter.latitude}:{lng:this._defaultPosition.lng,lat:this._defaultPosition.lat}}}]),n}(),$e=function(){function e(n){t(this,e),this.map=n.map||void 0,this.position=n.position||{lat:void 0,lng:void 0},this.icon=n.icon||void 0,this.label=n.label||void 0}return i(e,null,[{key:"serialize",value:function(e){var t=[];return e.forEach(function(e){t.push("markers=label:".concat(e.label,"|").concat(e.position.lat,",").concat(e.position.lng))}),t.join("&")}},{key:"from",value:function(t,n,i){var r=[];return Array.isArray(t)||(t=[t]),t.forEach(function(t){var o=n;"function"==typeof n&&(o=n(t.item,Je.DEFAULT_PIN_CONFIG,t));var a,s={};o.anchor&&(s.anchor=google.maps.Point(o.anchor.x,o.anchor.y)),o.scaledSize&&(s.scaledSize=new google.maps.Size(o.scaledSize.w,o.scaledSize.h)),o.url&&(s.url=o.url),o.svg&&(s.url="data:image/svg+xml;charset=utf-8, ".concat(encodeURIComponent(o.svg))),a=o.label?o.label:t.label.toString(),0===Object.keys(s).length&&(s=void 0),r.push(new e({map:i,position:{lat:t.latitude,lng:t.longitude},icon:s,label:a}))}),r}}]),e}(),Ze=function(e){function n(){return t(this,n),h(this,s(n).apply(this,arguments))}return a(n,Je),i(n,[{key:"loadJS",value:function(e){var t=this,n=V.createEl("script",{id:"yext-map-js",onload:function(){t._isLoaded=!0,mapboxgl.accessToken=t._apiKey,"function"==typeof e&&e(),"function"==typeof t._onLoaded&&t._onLoaded()},async:!0,src:"https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js"}),i=V.createEl("link",{id:"yext-map-css",rel:"stylesheet",href:"https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css"});V.append("body",i),V.append("body",n)}},{key:"init",value:function(e,t){var n=this;if((!t||t.mapMarkers.length<=0)&&!this._showEmptyMap)return this._map=null,this;var i=V.query(e);this._map=new mapboxgl.Map({container:i,zoom:this._zoom,style:"mapbox://styles/mapbox/streets-v9",center:this.getCenterMarker(t)}),t&&t.mapMarkers.length&&function(){for(var e=n._collapsePins?n._collapseMarkers(t.mapMarkers):t.mapMarkers,i=Xe.from(e,n._pinConfig,n._map),r=new mapboxgl.LngLatBounds,o=function(t){var o=i[t].wrapper,a=new mapboxgl.LngLat(i[t].position.longitude,i[t].position.latitude),s=new mapboxgl.Marker(o).setLngLat(a);r.extend(s.getLngLat()),s.addTo(n._map),n._onPinClick&&s.getElement().addEventListener("click",function(){return n._onPinClick(e[t].item)})},a=0;a<i.length;a++)o(a);i.length>=2&&n._map.fitBounds(r,{padding:50})}()}},{key:"getCenterMarker",value:function(e){return e&&e.mapCenter&&e.mapCenter.longitude&&e.mapCenter.latitude?[e.mapCenter.longitude,e.mapCenter.latitude]:{lng:this._defaultPosition.lng,lat:this._defaultPosition.lat}}}]),n}(),Xe=function(){function e(n){t(this,e),this.map=n.map||void 0,this.position=n.position||{latitude:void 0,longitude:void 0},this.wrapper=n.wrapper||void 0,this.label=n.label||void 0,this.staticMapPin=n.staticMapPin||void 0}return i(e,null,[{key:"serialize",value:function(e){var t=[];return e.forEach(function(e){e.staticMapPin?t.push("url-".concat(e.staticMapPin,"(").concat(e.position.longitude,",").concat(e.position.latitude,")")):t.push("pin-s-".concat(e.label,"(").concat(e.position.longitude,",").concat(e.position.latitude,")"))}),t.join(",")}},{key:"from",value:function(t,n,i){var r=[];return Array.isArray(t)||(t=[t]),t.forEach(function(t){var o=n;"function"==typeof n&&(o=n(t.item,Je.DEFAULT_PIN_CONFIG,t));var a=o.wrapper?o.wrapper:null,s=o.staticMapPin?o.staticMapPin:null;r.push(new e({map:i,position:{latitude:t.latitude,longitude:t.longitude},wrapper:a,label:t.label,staticMapPin:s}))}),r}}]),e}(),et={google:We,mapbox:Ze},tt=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,n),(e=h(this,s(n).call(this,i,r))).moduleId=N.VERTICAL_RESULTS,e._mapProvider=i.mapProvider,!(e._mapProvider&&e._mapProvider.toLowerCase()in et))throw new Error("MapComponent: Invalid Map Provider; must be `google` or `mapBox`");return e._map=null,e}return a(n,ue),i(n,[{key:"getProviderInstance",value:function(e){return new(et[e.toLowerCase()])(this._config)}},{key:"onCreate",value:function(){this._map=this.getProviderInstance(this._mapProvider),this._map.loadJS()}},{key:"onMount",value:function(){var e=this;this._map.onLoaded(function(){e._map.init(e._container,e.getState("map"))})}},{key:"setState",value:function(e,t){return 0===Object.keys(e).length?this:f(s(n.prototype),"setState",this).call(this,e,t)}}],[{key:"defaultTemplateName",value:function(e){return"results/map"}},{key:"type",get:function(){return"Map"}}]),n}(),nt="event",it="location",rt="people",ot=function(e){function n(){var e,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(i=h(this,s(n).call(this,o,a)))._verticalConfigId=o.verticalConfigId,i._isUniversal=o.isUniversal||!1,i.moduleId=N.VERTICAL_RESULTS,i._itemConfig=(r(e={global:{render:null,template:null}},Ge.type,{render:null,template:null}),r(e,Qe.type,{render:null,template:null}),r(e,Ye.type,{render:null,template:null}),e),void 0===o.renderItem&&void 0!==o._parentOpts&&(o.renderItem=o._parentOpts.renderItem),void 0===o.itemTemplate&&void 0!==o._parentOpts&&(o.itemTemplate=o._parentOpts.itemTemplate),i.configureItem({render:o.renderItem,template:o.itemTemplate}),i._universalUrl=o.universalUrl,i}return a(n,ue),i(n,[{key:"mount",value:function(){return Object.keys(this.getState()).length>0&&f(s(n.prototype),"mount",this).call(this),this}},{key:"setState",value:function(e,t){var i=e.results||[],r=e.searchState||g.PRE_SEARCH;return f(s(n.prototype),"setState",this).call(this,Object.assign({results:[]},e,{isPreSearch:r===g.PRE_SEARCH,isSearchLoading:r===g.SEARCH_LOADING,isSearchComplete:r===g.SEARCH_COMPLETE,includeMap:this._config.includeMap,mapConfig:this._config.mapConfig,eventOptions:this.eventOptions(),universalUrl:this._universalUrl?this._universalUrl+window.location.search:"",showNoResults:0===i.length,query:this.core.globalStorage.getState(N.QUERY)}),t)}},{key:"eventOptions",value:function(){return JSON.stringify({verticalConfigId:this._verticalConfigId})}},{key:"configureItem",value:function(e){if("function"==typeof e.render)this._itemConfig.global.render=e.render;else for(var t in e.render)this.setItemRender(t,e.render[t]);if("string"==typeof e.template)this._itemConfig.global.template=e.template;else for(var n in e.template)this.setItemTemplate(n,e.template[n])}},{key:"setItemTemplate",value:function(e,t){var n=this.getItemComponent(e);this._itemConfig[n.type].template=t}},{key:"setItemRender",value:function(e,t){var n=this.getItemComponent(e);this._itemConfig[n.type].render=t}},{key:"getItemComponent",value:function(e){var t=ze;switch(e){case nt:t=Ge;break;case it:t=Qe;break;case rt:t=Ye}return t}},{key:"addChild",value:function(e,t,i){if(t===ze.type){var r=this.getItemComponent(e.type);r&&(t=r.type)}else if(t===tt.type){e={map:e};var o=Object.assign({},this._config.mapConfig,i);return f(s(n.prototype),"addChild",this).call(this,e,t,o)}var a=f(s(n.prototype),"addChild",this).call(this,e,t,Object.assign(i,{verticalConfigId:this._verticalConfigId,isUniversal:this._isUniversal})),l=this._itemConfig.global,u=this._itemConfig[a.type],c="function"==typeof l.render,h="string"==typeof l.template;return c&&a.setRender(l.render),h&&a.setTemplate(l.template),u?(!c&&u.render&&a.setRender(u.render),!h&&u.template&&a.setTemplate(u.template),a):a}}],[{key:"defaultTemplateName",value:function(e){return"results/results"}},{key:"duplicatesAllowed",get:function(){return!0}},{key:"type",get:function(){return"VerticalResults"}}]),n}(),at=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r)))._selectorBase=i.selectorBase||".js-yxt-AccordionResult",e.collapsedClass=i.collapsedClass||"is-collapsed",e.verticalConfigId=i.verticalConfigId||i._parentOpts.verticalConfigId||null,e}return a(n,ot),i(n,[{key:"onMount",value:function(){var e=this;f(s(n.prototype),"onMount",this).call(this);var t=this._container.firstElementChild;return V.queryAll(t,this._selectorBase).forEach(function(t){var n=V.query(t,e.toggleSelector()),i=V.query(t,e.bodySelector());e.changeHeight(i,t),n.addEventListener("click",function(){e.handleClick(t,n,i)})}),this}},{key:"setState",value:function(e){return f(s(n.prototype),"setState",this).call(this,Object.assign({},e,{modifier:this.verticalConfigId}))}},{key:"handleClick",value:function(e,t,n){var i=new re(this.isCollapsed(e)?"ROW_EXPAND":"ROW_COLLAPSE").addOptions({verticalConfigId:this.verticalConfigId,entityId:t.dataset.entityId});e.classList.toggle(this.collapsedClass),this.changeHeight(n,e),t.setAttribute("aria-expanded",this.isCollapsed(e)?"false":"true"),this.analyticsReporter.report(i)}},{key:"isCollapsed",value:function(e){return!!e&&e.classList.contains(this.collapsedClass)}},{key:"changeHeight",value:function(e,t){e.style.height="".concat(this.isCollapsed(t)?0:e.scrollHeight,"px")}},{key:"buildSelector",value:function(e){return"".concat(this._selectorBase).concat(e)}},{key:"toggleSelector",value:function(){return this.buildSelector("-toggle")}},{key:"bodySelector",value:function(){return this.buildSelector("-body")}}],[{key:"defaultTemplateName",value:function(e){return"results/resultsaccordion"}},{key:"type",get:function(){return"AccordionResults"}}]),n}(),st=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).moduleId=N.UNIVERSAL_RESULTS,e._limit=i.limit||10,e}return a(n,ue),i(n,[{key:"init",value:function(e){return f(s(n.prototype),"init",this).call(this,e),this}},{key:"setState",value:function(e,t){var i=e.sections||[],r=e.searchState||g.PRE_SEARCH;return f(s(n.prototype),"setState",this).call(this,Object.assign({sections:[]},e,{isPreSearch:r===g.PRE_SEARCH,isSearchLoading:r===g.SEARCH_LOADING,isSearchComplete:r===g.SEARCH_COMPLETE,showNoResults:0===i.length,query:this.core.globalStorage.getState(N.QUERY)}),t)}},{key:"addChild",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=o({},arguments.length>2?arguments[2]:void 0,{},this.getChildConfig([e.verticalConfigId]));return!0===i.useAccordion?f(s(n.prototype),"addChild",this).call(this,e,at.type,i):f(s(n.prototype),"addChild",this).call(this,e,t,i)}},{key:"getChildConfig",value:function(e){var t={verticalConfigId:e,isUniversal:!0};return void 0===this._config.config?t:Object.assign(t,this._config.config[e]||this._config.config)}}],[{key:"defaultTemplateName",value:function(e){return"results/universalresults"}},{key:"areDuplicateNamesAllowed",value:function(){return!0}},{key:"type",get:function(){return"UniversalResults"}}]),n}(),lt=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t(this,n),(e=h(this,s(n).call(this,i,r)))._verticalKey=e.core.globalStorage.getState(N.SEARCH_CONFIG).verticalKey,"string"!=typeof e._verticalKey)throw new b("verticalKey not provided, but necessary for pagination","PaginationComponent");e._firstPageButtonEnabled=void 0===i.showFirst||i.showFirst,e._lastPageButtonEnabled=void 0===i.showLast||i.showLast,e._analyticsOptions={verticalKey:e._verticalKey};var o=e.core.globalStorage.getState(N.SEARCH_OFFSET)||0;return e.core.globalStorage.set(N.SEARCH_OFFSET,Number(o)),e.core.globalStorage.on("update",N.SEARCH_OFFSET,function(t){"number"!=typeof t&&e.core.globalStorage.set(N.SEARCH_OFFSET,Number(t))}),e.core.globalStorage.on("update",N.VERTICAL_RESULTS,function(t){t.searchState===g.SEARCH_COMPLETE&&e.setState()}),e}return a(n,ue),i(n,[{key:"onMount",value:function(){var e=this,t=this.core.globalStorage.getState(N.VERTICAL_RESULTS)||{},n=this.core.globalStorage.getState(N.SEARCH_CONFIG).limit,i="search-complete"===t.searchState&&t.resultsCount>n,r=this.core.globalStorage.getState(N.SEARCH_OFFSET)||0;if(i){var o=V.query(this._container,".js-yxt-Pagination-previous"),a=V.query(this._container,".js-yxt-Pagination-next"),s=Math.trunc((t.resultsCount-1)/n);if(V.on(o,"click",function(){return e.updatePage(r-n)}),V.on(a,"click",function(){return e.updatePage(r+n)}),this._firstPageButtonEnabled){var l=V.query(this._container,".js-yxt-Pagination-first");V.on(l,"click",function(){return e.updatePage(0)})}if(this._lastPageButtonEnabled){var u=V.query(this._container,".js-yxt-Pagination-last");V.on(u,"click",function(){return e.updatePage(s*n)})}}}},{key:"updatePage",value:function(e){this.scrollToTop(),this.core.globalStorage.set(N.SEARCH_OFFSET,e),this.core.persistentStorage.set(N.SEARCH_OFFSET,e),this.core.verticalPage(this._verticalKey,e)}},{key:"scrollToTop",value:function(){document.documentElement.scrollTop=0,document.body.scrollTop=0}},{key:"setState",value:function(e){var t=this.core.globalStorage.getState(N.VERTICAL_RESULTS)||{},i=this.core.globalStorage.getState(N.SEARCH_OFFSET)||0,r=this.core.globalStorage.getState(N.SEARCH_CONFIG).limit,a=i/r,l="search-complete"===t.searchState&&t.resultsCount>r,u=t.resultsCount>i+r,c=Math.trunc((t.resultsCount-1)/r);return f(s(n.prototype),"setState",this).call(this,o({showControls:l,firstPageButtonEnabled:this._firstPageButtonEnabled,lastPageButtonEnabled:this._lastPageButtonEnabled,pageNumber:a+1,showFirstPageButton:a>1,showPreviousPageButton:a>0,showNextPageButton:u,showLastPageButton:a<c-1},e))}}],[{key:"defaultTemplateName",value:function(){return"results/pagination"}},{key:"type",get:function(){return"Pagination"}}]),n}(),ut={entityId:null,language:"EN",formSelector:"form",emailLabel:"Email",nameLabel:"Name",questionLabel:"Question",privacyPolicyLabel:"By submitting my email address, I consent to being contacted via email at the address provided.",buttonLabel:"Submit",sectionTitle:"Feedback",sectionDescription:"Can’t find what you are looking for? Provide your feedback below.",sectionTitleIconName:"support",feedbackFormInfoText:"Enter your question and contact information, and we'll get back to you with a response shortly.",requiredInputPlaceholder:"(required)",questionInputPlaceholder:"Enter your question here",questionSubmissionConfirmationText:"Thank you for your feedback!"},ct=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,Object.assign({},ut,i),r))).moduleId=N.QUESTION_SUBMISSION,e._verticalKey=e.core.globalStorage.getState(N.SEARCH_CONFIG).verticalKey,e.validateConfig(),e.core.globalStorage.on("update",N.QUERY_ID,function(){var t=e.core.globalStorage.getState(N.QUERY);e.setState(new D({questionText:t,expanded:e._config.expanded}))}),e}return a(n,ue),i(n,[{key:"validateConfig",value:function(){if(null===this._config.entityId||void 0===this._config.entityId)throw new b("`entityId` is a required configuration option for Question Submission","QuestionSubmission")}},{key:"beforeMount",value:function(){return Object.keys(this.getState()).length>1}},{key:"onMount",value:function(){var e=V.query(this._container,this._config.formSelector);null!==e&&(this.bindFormFocus(e),this.bindFormSubmit(e))}},{key:"bindFormFocus",value:function(e){var t=this;if(null!==this.analyticsReporter){var n=V.query(e,".js-question-text");V.on(n,"focus",function(){t.analyticsReporter.report(t.getAnalyticsEvent("QUESTION_FOCUS"))})}}},{key:"bindFormSubmit",value:function(e){var t=this;V.on(e,"submit",function(n){n.preventDefault(),t.analyticsReporter.report(t.getAnalyticsEvent("QUESTION_SUBMIT"));var i=t.parse(e),r=t.validateRequired(i);if(r)return t.setState(new D(i,r));t.core.submitQuestion({entityId:t._config.entityId,questionLanguage:t._config.language,site:"FIRSTPARTY",name:i.name,email:i.email,questionText:i.questionText,questionDescription:i.questionDescription}).catch(function(e){throw t.setState(new D(i,{network:"We're sorry, an error occurred."})),e})})}},{key:"parse",value:function(e){var t=V.queryAll(e,".js-question-field");if(!t||0===t.length)return{};for(var n={},i=0;i<t.length;i++){var r=t[i].value;"checkbox"===t[i].type&&"true"===r&&(r=!0),n[t[i].name]=r}return n}},{key:"validateRequired",value:function(e){var t={};return e.email&&"string"==typeof e.email||(t.email="Missing email address!"),e.privacyPolicy&&!0===e.privacyPolicy||(t.privacyPolicy="Approving our privacy policy terms is required!"),e.questionText&&"string"==typeof e.questionText||(t.questionText="Question text is required!"),Object.keys(t).length>0?t:null}},{key:"getAnalyticsEvent",value:function(e){var t=new re(e);return t.addOptions({verticalConfigId:this._verticalKey,searcher:this._verticalKey?"VERTICAL":"UNIVERSAL"}),t}}],[{key:"defaultTemplateName",value:function(e){return"questions/questionsubmission"}},{key:"type",get:function(){return"QASubmission"}}]),n}(),ht=function(){function e(n){t(this,e),this.name=n.name,this.path=n.path,this.complexContents=n.complexContents,this.viewBox=n.viewBox||"0 0 24 24",this.contents=this.pathDefinition()}return i(e,[{key:"pathDefinition",value:function(){return this.complexContents?this.complexContents:'<path d="'.concat(this.path,'"></path>')}},{key:"markup",value:function(){return'<svg viewBox="'.concat(this.viewBox,'" xmlns="http://www.w3.org/2000/svg">').concat(this.contents,"</svg>")}}]),e}(),ft=new ht({name:"thumb",viewBox:"0 0 24 22",path:"M15.273 1H5.455c-.906 0-1.68.55-2.008 1.342L.153 10.097A2.19 2.19 0 000 10.9v2.2c0 1.21.982 2.2 2.182 2.2h6.883L8.03 20.327l-.033.352c0 .451.186.869.48 1.166L9.633 23l7.178-7.249a2.16 2.16 0 00.644-1.551v-11c0-1.21-.982-2.2-2.182-2.2zm0 13.2l-4.735 4.774L11.75 13.1H2.182v-2.2l3.273-7.7h9.818v11zM19.636 1H24v13.2h-4.364V1z"}),pt=new ht({name:"receipt",path:"M14.606 9.5c-.671-.515-1.591-.833-2.606-.833 1.015 0 1.935.318 2.606.833zm-7.985 0H1.655A1.66 1.66 0 010 7.833V3.667C0 2.747.741 2 1.655 2h20.69A1.66 1.66 0 0124 3.667v4.166A1.66 1.66 0 0122.345 9.5h-4.966V22H6.621V9.5h2.773H6.62zm10.758-1.667h4.966V3.667H1.655v4.166h4.966v-2.5h10.758v2.5z"}),dt=new ht({name:"pantheon",path:"M9.947 16.598h.252V9.412h-.252a.432.432 0 01-.23-.065c-.07-.043-.106-.093-.106-.15L9.15 7.82v-.15c0-.044.028-.08.084-.109a.691.691 0 01.105-.086.254.254 0 01.146-.043H13.6c.056 0 .104.015.146.043.042.03.091.058.147.086a.271.271 0 01.063.108c.014.043.007.093-.02.15l-.42 1.378a.374.374 0 01-.147.15.37.37 0 01-.19.065h-.251v7.186h.252a.37.37 0 01.189.065c.07.043.119.093.147.15l.42 1.378c.027.028.034.071.02.129a.275.275 0 01-.063.129 1.364 1.364 0 00-.147.086.254.254 0 01-.146.043H9.485a.254.254 0 01-.146-.043.691.691 0 01-.105-.086c-.056-.029-.084-.072-.084-.13v-.128l.461-1.377c0-.058.035-.108.105-.151a.432.432 0 01.231-.065zm5.792 0h.252V9.412h-.252a.432.432 0 01-.23-.065.374.374 0 01-.148-.15l-.42-1.377c-.027-.029-.034-.072-.02-.13a.275.275 0 01.063-.129c.056-.028.105-.057.146-.086a.254.254 0 01.147-.043h4.114c.055 0 .104.015.146.043a.691.691 0 01.105.086c.056.03.084.072.084.13v.129l-.42 1.377a.374.374 0 01-.146.15.432.432 0 01-.231.065h-.21v7.186h.21a.43.43 0 01.23.065c.07.043.12.093.148.15l.42 1.378v.15c0 .043-.029.08-.085.108a.691.691 0 01-.105.086.254.254 0 01-.146.043h-4.114a.254.254 0 01-.147-.043 1.364 1.364 0 00-.146-.086.271.271 0 01-.063-.108c-.014-.043-.007-.093.02-.15l.42-1.377a.374.374 0 01.147-.151.432.432 0 01.231-.065zm-11.794-.086h.252V9.498h-.252a.334.334 0 01-.21-.065.386.386 0 01-.126-.193l-.42-1.377a.248.248 0 01-.02-.172.854.854 0 01.063-.173c.028-.057.07-.1.126-.129a.365.365 0 01.168-.043h4.07c.057 0 .113.015.169.043a.278.278 0 01.126.13.854.854 0 01.062.172.248.248 0 01-.02.172l-.42 1.377a.386.386 0 01-.126.193.334.334 0 01-.21.065h-.21v7.014h.21c.084 0 .154.029.21.086a.673.673 0 01.126.172l.42 1.378a.248.248 0 01.02.172.854.854 0 01-.062.172.278.278 0 01-.126.129.365.365 0 01-.168.043H3.526a.365.365 0 01-.168-.043.278.278 0 01-.126-.13.854.854 0 01-.063-.171.248.248 0 01.02-.172l.42-1.378a.673.673 0 01.126-.172.281.281 0 01.21-.086zM1.763 6.658a.717.717 0 01-.504-.194.644.644 0 01-.21-.495v-.43a.73.73 0 01.105-.387.68.68 0 01.273-.259C4.309 3.402 6.54 2.276 8.121 1.515 9.702.755 10.493.361 10.493.332c.531-.258.972-.366 1.322-.323.35.043.734.165 1.154.366l8.31 4.518c.14.058.245.144.315.259a.73.73 0 01.105.387v.43c0 .201-.07.366-.21.495a.717.717 0 01-.504.194H1.763zm-.714 13.34a.54.54 0 01.168-.387.516.516 0 01.378-.172h19.642c.168 0 .308.057.42.172a.541.541 0 01.168.387v.818a.522.522 0 01-.168.408.605.605 0 01-.42.151H1.595a.551.551 0 01-.378-.15.522.522 0 01-.168-.41v-.817zm21.405 2.022c.14 0 .266.058.378.173a.592.592 0 01.168.43v.818a.541.541 0 01-.168.387.516.516 0 01-.378.172L.546 23.957a.516.516 0 01-.378-.172.541.541 0 01-.168-.387v-.818a.59.59 0 01.168-.43.516.516 0 01.378-.173l21.908.043z"}),gt=new ht({name:"mic",path:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.41 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"}),vt=new ht({name:"directions",path:"M23.649 11.154L12.846.35a1.195 1.195 0 00-1.692 0L.35 11.154a1.195 1.195 0 000 1.692L11.154 23.65a1.195 1.195 0 001.692 0L23.65 12.846c.468-.456.468-1.212 0-1.692zm-9.254 3.853v-3.001H9.593v3.6h-2.4v-4.8c0-.66.54-1.2 1.2-1.2h6.002V6.604l4.2 4.2-4.2 4.202z"}),yt=new ht({name:"calendar",path:"M18.111 13.2H12v6h6.111v-6zM16.89 0v2.4H7.11V0H4.667v2.4H3.444c-1.356 0-2.432 1.08-2.432 2.4L1 21.6C1 22.92 2.088 24 3.444 24h17.112C21.9 24 23 22.92 23 21.6V4.8c0-1.32-1.1-2.4-2.444-2.4h-1.223V0H16.89zm3.667 21.6H3.444V8.4h17.112v13.2z"}),mt=new ht({name:"callout",path:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4-.01-18z"}),_t=new ht({name:"info",path:"M12 8.4A1.2 1.2 0 1012 6a1.2 1.2 0 000 2.4zM12 0c6.624 0 12 5.376 12 12s-5.376 12-12 12S0 18.624 0 12 5.376 0 12 0zm0 18c.66 0 1.2-.54 1.2-1.2V12c0-.66-.54-1.2-1.2-1.2-.66 0-1.2.54-1.2 1.2v4.8c0 .66.54 1.2 1.2 1.2z"}),St=new ht({name:"briefcase",path:"M20 7h-4V5c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 20c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V9c0-1.11-.89-2-2-2zm-6 0h-4V5h4v2z"}),bt=new ht({name:"kabob",viewBox:"0 0 3 11",complexContents:'<circle cx="1.5" cy="1.5" r="1.5"/><circle cx="1.5" cy="5.5" r="1.5"/><circle cx="1.5" cy="9.5" r="1.5"/>'}),kt=new ht({name:"person",viewBox:"0 0 18 18",path:"M9 9c2.486 0 4.5-2.014 4.5-4.5S11.486 0 9 0a4.499 4.499 0 00-4.5 4.5C4.5 6.986 6.514 9 9 9zm0 2.25c-3.004 0-9 1.508-9 4.5v1.125C0 17.494.506 18 1.125 18h15.75c.619 0 1.125-.506 1.125-1.125V15.75c0-2.992-5.996-4.5-9-4.5z"}),wt=new ht({name:"magnifying_glass",path:"M16.124 13.051a5.154 5.154 0 110-10.308 5.154 5.154 0 010 10.308M16.114 0a7.886 7.886 0 00-6.46 12.407L0 22.06 1.94 24l9.653-9.653A7.886 7.886 0 1016.113 0"}),Ct=new ht({name:"office",path:"M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"}),Et=new ht({name:"link",path:"M2.28 12A3.723 3.723 0 016 8.28h4.8V6H6c-3.312 0-6 2.688-6 6s2.688 6 6 6h4.8v-2.28H6A3.723 3.723 0 012.28 12zm4.92 1.2h9.6v-2.4H7.2v2.4zM18 6h-4.8v2.28H18A3.723 3.723 0 0121.72 12 3.723 3.723 0 0118 15.72h-4.8V18H18c3.312 0 6-2.688 6-6s-2.688-6-6-6z"}),Lt=new ht({name:"window",path:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"}),It=new ht({name:"phone",path:"M4.827 10.387a20.198 20.198 0 008.786 8.786l2.934-2.933c.36-.36.893-.48 1.36-.32a15.21 15.21 0 004.76.76c.733 0 1.333.6 1.333 1.333v4.654C24 23.4 23.4 24 22.667 24 10.147 24 0 13.853 0 1.333 0 .6.6 0 1.333 0H6c.733 0 1.333.6 1.333 1.333 0 1.667.267 3.267.76 4.76.147.467.04.987-.333 1.36l-2.933 2.934z"}),Ot=new ht({name:"tag",viewBox:"0 0 18 18",path:"M17.469 8.622l-8.1-8.1A1.789 1.789 0 008.1 0H1.8C.81 0 0 .81 0 1.8v6.3c0 .495.198.945.531 1.278l8.1 8.1c.324.324.774.522 1.269.522a1.76 1.76 0 001.269-.531l6.3-6.3A1.76 1.76 0 0018 9.9c0-.495-.207-.954-.531-1.278zM3.15 4.5c-.747 0-1.35-.603-1.35-1.35 0-.747.603-1.35 1.35-1.35.747 0 1.35.603 1.35 1.35 0 .747-.603 1.35-1.35 1.35z"}),Tt=new ht({name:"document",path:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"}),xt=new ht({name:"chevron",viewBox:"0 0 7 9",complexContents:'<g fill-rule="evenodd" transform="translate(-1 -8)"><path d="m2.6417004 8-1.1417004 1.0575 3.70850202 3.4425-3.70850202 3.4425 1.1417004 1.0575 4.8582996-4.5z"/></g>'}),At=new ht({name:"support",path:"M12.5 2C7.81 2 4 5.81 4 10.5c0 4.69 3.81 8.5 8.5 8.5h.5v3c4.86-2.34 8-7 8-11.5C21 5.81 17.19 2 12.5 2zm1 14.5h-2v-2h2v2zm0-3.5h-2c0-3.25 3-3 3-5 0-1.1-.9-2-2-2s-2 .9-2 2h-2c0-2.21 1.79-4 4-4s4 1.79 4 4c0 2.5-3 2.75-3 5z"}),Rt=new ht({name:"yext",viewBox:"0 0 30 30",path:"M25.517 28.142v.095h-.204v.905h-.066v-.905h-.197v-.095h.467zm.667 0h.066v1h-.066v-.825l-.24.595h-.013l-.24-.595v.825h-.066v-1h.066l.247.61.246-.61zM15 28.8c7.622 0 13.8-6.178 13.8-13.8 0-7.622-6.178-13.8-13.8-13.8C7.378 1.2 1.2 7.378 1.2 15c0 7.622 6.178 13.8 13.8 13.8zM15 0c8.284 0 15 6.716 15 15 0 8.284-6.716 15-15 15-8.284 0-15-6.716-15-15C0 6.716 6.716 0 15 0zm.45 16.65v-1.2h6.6v1.2h-2.7v5.4h-1.2v-5.4h-2.7zm-1.599-1.35l.849.849-2.601 2.601 2.601 2.601-.849.849-2.601-2.601L8.649 22.2l-.849-.849 2.601-2.601L7.8 16.149l.849-.849 2.601 2.601 2.601-2.601zM18.675 9a2.175 2.175 0 00-1.847 3.323l2.995-2.995A2.163 2.163 0 0018.675 9zm0 5.55a3.375 3.375 0 112.833-5.209l-3.789 3.788a2.175 2.175 0 003.13-1.954h1.201a3.375 3.375 0 01-3.375 3.375zm-7.425-3.734L13.78 7.8l.92.771-2.85 3.397v2.582h-1.2v-2.582L7.8 8.57l.92-.771 2.53 3.016z"}),Ft=new ht({name:"pin",viewBox:"0 0 13 18",path:"m9.375 0c-3.52446429 0-6.375 2.817-6.375 6.3 0 4.725 6.375 11.7 6.375 11.7s6.375-6.975 6.375-11.7c0-3.483-2.8505357-6.3-6.375-6.3zm.00000018 8.55000007c-1.25678576 0-2.27678579-1.008-2.27678579-2.25s1.02000003-2.25 2.27678579-2.25c1.25678572 0 2.27678582 1.008 2.27678582 2.25s-1.0200001 2.25-2.27678582 2.25z"}),Nt=new ht({name:"gear",path:"M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm7-7H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2zm-1.75 9c0 .23-.02.46-.05.68l1.48 1.16c.13.11.17.3.08.45l-1.4 2.42c-.09.15-.27.21-.43.15l-1.74-.7c-.36.28-.76.51-1.18.69l-.26 1.85c-.03.17-.18.3-.35.3h-2.8c-.17 0-.32-.13-.35-.29l-.26-1.85c-.43-.18-.82-.41-1.18-.69l-1.74.7c-.16.06-.34 0-.43-.15l-1.4-2.42a.353.353 0 01.08-.45l1.48-1.16c-.03-.23-.05-.46-.05-.69 0-.23.02-.46.05-.68l-1.48-1.16a.353.353 0 01-.08-.45l1.4-2.42c.09-.15.27-.21.43-.15l1.74.7c.36-.28.76-.51 1.18-.69l.26-1.85c.03-.17.18-.3.35-.3h2.8c.17 0 .32.13.35.29l.26 1.85c.43.18.82.41 1.18.69l1.74-.7c.16-.06.34 0 .43.15l1.4 2.42c.09.15.05.34-.08.45l-1.48 1.16c.03.23.05.46.05.69z"}),Mt=new ht({name:"light_bulb",viewBox:"0 0 32 35",path:"M11.585 31.056l8.38-.493v-.986l-8.38.493zM11.585 33.028L15.775 35l4.19-1.972V31.55l-8.38.493v.986zm6.926-.407l-2.736 1.29-2.13-1.004 4.866-.286zM15.775 7.394c-4.63 0-8.38 3.205-8.38 8.38 0 5.177 4.19 6.902 4.19 12.818v.493l8.38-.493c0-5.916 4.19-8.188 4.19-12.817a8.38 8.38 0 00-8.38-8.38zm5.617 13.48c-1.025 1.837-2.174 3.892-2.381 6.786l-6.44.38c-.129-3.01-1.29-5.021-2.32-6.808-.493-.8-.928-1.636-1.299-2.5h13.556c-.325.708-.704 1.403-1.116 2.142zm1.479-3.128H8.627a7.793 7.793 0 01-.247-1.971c0-4.353 3.042-7.395 7.395-7.395a7.394 7.394 0 017.394 7.395 6.739 6.739 0 01-.3 1.971h.002zM26.62 15.282h4.93v1h-4.93zM23.094 7.756l2.091-2.091.698.697-2.092 2.092zM15.282 0h1v4.93h-1zM5.666 6.362l.697-.697 2.091 2.091-.697.697zM0 15.282h4.93v1H0z"}),qt=new ht({name:"receipt",viewBox:"0 0 18 18",path:"M8.991 0C4.023 0 0 4.032 0 9s4.023 9 8.991 9C13.968 18 18 13.968 18 9s-4.032-9-9.009-9zm3.816 14.4L9 12.105 5.193 14.4l1.008-4.329-3.357-2.907 4.428-.378L9 2.7l1.728 4.077 4.428.378-3.357 2.907z"}),Ut=new ht({name:"close",complexContents:'\n    <path d="M7 8l9.716 9.716m0-9.716L7 17.716" \n          stroke="currentColor" \n          stroke-width="2"/>\n  '}),Kt=new ht({name:"elements",path:"M13,15 L13,17 L21,17 L21,19 L13,19 L13,21 L11,21 L11,15 L13,15 Z M9,17 L9,19 L3,19 L3,17 L9,17 Z M9,15 L7,15 L7,13 L3,13 L3,11 L7,11 L7,9 L9,9 L9,15 Z M21,11 L21,13 L11,13 L11,11 L21,11 Z M17,3 L17,5 L21,5 L21,7 L17,7 L17,9 L15,9 L15,3 L17,3 Z M13,5 L13,7 L3,7 L3,5 L13,5 Z"}),Dt={};[ft,pt,dt,gt,vt,yt,mt,_t,St,bt,kt,wt,Ct,Et,Lt,It,Ot,Tt,xt,At,Rt,Ft,Nt,Mt,Kt,Ut].forEach(function(e){Dt[e.name]=e.markup()}),Dt.default=qt.markup();var Pt=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,n),(e=h(this,s(n).call(this,i,r))).iconName=i.iconName||"default",e.customIcon=i.customIcon||null,e.iconUrl=i.iconUrl||null,e}return a(n,ue),i(n,[{key:"setState",value:function(e){return f(s(n.prototype),"setState",this).call(this,Object.assign(e,{image:this.image,name:this.iconName?this.iconName:"custom"}))}},{key:"image",get:function(){return this.customIcon?this.customIcon:this.iconUrl?'<img src="'.concat(this.iconUrl,'" alt="" class="Icon-image">'):Dt[this.iconName]?Dt[this.iconName]:Dt.default}}],[{key:"defaultTemplateName",value:function(e){return"icons/icon"}},{key:"areDuplicateNamesAllowed",value:function(){return!0}},{key:"type",get:function(){return"IconComponent"}}]),n}(),Ht=(new B).register(ue).register(he).register(fe).register(pe).register(Ie).register(Oe).register(Te).register(Re).register(Me).register(qe).register(Ue).register(De).register(He).register(Be).register(st).register(ot).register(lt).register(ze).register(at).register(Qe).register(Ge).register(Ye).register(tt).register(ct).register(Pt),jt=function(){function e(n){if(t(this,e),!e.setInstance(this))return e.getInstance();this._templateUrl=n.templateUrl||X,this._templates={},this._onLoaded=function(){},this._init()}return i(e,[{key:"_init",value:function(){this.fetchTemplates()}},{key:"fetchTemplates",value:function(){var e=this;if(!V.query("#yext-answers-templates"))return new Promise(function(t,n){var i=V.createEl("script",{id:"yext-answers-templates",onload:t,onerror:n,async:!0,src:e._templateUrl});V.append("body",i)}).then(function(e){console.log("Templates loaded successfully!")}),this}},{key:"register",value:function(e){return this._templates=e,this._onLoaded(this._templates),this}},{key:"onLoaded",value:function(e){return this._onLoaded=e,this}},{key:"get",value:function(e){return this._templates[e]}},{key:"getTemplates",value:function(){return this._templates}}],[{key:"setInstance",value:function(e){return!this.instance&&(this.instance=e,!0)}},{key:"getInstance",value:function(){return this.instance}}]),e}(),Vt=function(){function e(n){var i=this;t(this,e),this.apiKey=n.apiKey,this.experienceKey=n.experienceKey,this.experienceVersion=n.experienceVersion||"config1.0",this.printVerbose=n.printVerbose,this.sendToServer=n.sendToServer,window.addEventListener("error",function(e){return i.report(e.error)}),window.addEventListener("unhandledrejection",function(e){return i.report(e.error)})}return i(e,[{key:"report",value:function(e){if(e instanceof m&&!e.reported){if(e.reported=!0,this.printError(e),this.sendToServer)new ne({endpoint:"/v2/accounts/me/answers/errors",apiKey:this.apiKey,version:20190301,params:{error:e.toJson(),libVersion:"v0.10.1",experienceVersion:this.experienceVersion,experienceKey:this.experienceKey}}).get().catch(console.err);return e}}},{key:"printError",value:function(e){console.error(e.toString()),this.printVerbose&&console.log(o({},e))}}]),e}(),Bt=function(){function e(){t(this,e)}return i(e,[{key:"report",value:function(e){console.error(e.toString())}}]),e}(),zt=function(){function e(){var n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this._params=new te(window.location.search.substring(1)),this._historyTimer=null,this._updateListener=i.updateListener||function(){},this._resetListener=i.resetListener||function(){},window.onpopstate=function(){n._params=new te(window.location.search.substring(1)),n._callListener(n._updateListener),n._callListener(n._resetListener)}}return i(e,[{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof e)throw new C("Storage data key must be a string",e,t);var i=t;"string"!=typeof t&&(i=JSON.stringify(t)),this._params.set(e,i),this._updateHistory(n)}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._params.delete(e),this._updateHistory(t)}},{key:"_updateHistory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(function(){e._historyTimer=null,t?window.history.replaceState(null,null,"?".concat(e._params.toString())):window.history.pushState(null,null,"?".concat(e._params.toString())),e._callListener(e._updateListener)})}},{key:"_callListener",value:function(e){e(this.getAll(),this._params.toString())}},{key:"getAll",value:function(){var e={},t=!0,n=!1,i=void 0;try{for(var r,o=this._params.entries()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=p(r.value,2),s=a[0],l=a[1];e[s]=l}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return e}}]),e}(),Qt=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.limit=n.limit||20,this.verticalKey=n.verticalKey||null,this.defaultInitialSearch=n.defaultInitialSearch,this.validate(),Object.freeze(this)}return i(e,[{key:"validate",value:function(){if("number"!=typeof this.limit||this.limit<1||this.limit>50)throw new S("Search Limit must be between 1 and 50","SearchConfig")}}]),e}(),Gt=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.sections=n.sections||[],this.queryId=n.queryId||"",Object.freeze(this)}return i(e,null,[{key:"from",value:function(t){return new e({sections:t.sections?t.sections.map(function(e){return{label:e.label,results:e.results.map(function(e){return new Yt(e)})}}):[{results:t.results.map(function(e){return new Yt(e)})}],queryId:t.queryId})}}]),e}(),Yt=function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(this,e),this.filter=n.filter||{},this.highlightedValue=new y(n).getInverted(),this.key=n.key||"",this.matchedSubstrings=n.matchedSubstrings||[],this.value=n.value||"",this.shortValue=n.shortValue||this.value,Object.freeze(this)},Jt=function(){function e(){t(this,e)}return i(e,null,[{key:"clean",value:function(e,t){return t.sections&&0===t.sections.length&&delete t.sections,t.sections&&1===t.sections.length&&0===t.sections[0].results.length&&delete t.sections,r({},e,t)}},{key:"universal",value:function(e){return Gt.from(e)}},{key:"filter",value:function(e){return Gt.from(e)}},{key:"vertical",value:function(e){return Gt.from(e)}}]),e}(),Wt=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t(this,e),!n.apiKey)throw new _("Api Key is required","AutoComplete");if(this._apiKey=n.apiKey,!n.experienceKey)throw new _("Answers Key is required","AutoComplete");if(this._experienceKey=n.experienceKey,this._version=n.version||20190101,this._experienceVersion=n.experienceVersion,!n.locale)throw new _("Locale is required","AutoComplete");this._locale=n.locale}return i(e,[{key:"queryFilter",value:function(e,t){return new ne({endpoint:"/v2/accounts/me/answers/filtersearch",apiKey:this._apiKey,version:this._version,params:{input:e,experienceKey:this._experienceKey,version:this._experienceVersion,verticalKey:t.verticalKey,inputKey:t.barKey,locale:this._locale,search_parameters:JSON.stringify(t.searchParameters)}}).get().then(function(e){return e.json()}).then(function(e){return Jt.filter(e.response,t.barKey)}).catch(function(e){throw new k("Filter search request failed","AutoComplete",e)})}},{key:"queryVertical",value:function(e,t,n){var i=new ne({endpoint:"/v2/accounts/me/answers/vertical/autocomplete",apiKey:this._apiKey,version:this._version,params:{input:e,experienceKey:this._experienceKey,version:this._experienceVersion,verticalKey:t,barKey:n,locale:this._locale}});return i.get().then(function(e){return e.json()}).then(function(e){return Jt.vertical(e.response,i._params.barKey)}).catch(function(e){throw new k("Vertical search request failed","AutoComplete",e)})}},{key:"queryUniversal",value:function(e){return new ne({endpoint:"/v2/accounts/me/answers/autocomplete",apiKey:this._apiKey,version:this._version,params:{input:e,experienceKey:this._experienceKey,version:this._experienceVersion,locale:this._locale}}).get(e).then(function(e){return e.json()}).then(function(e){return Jt.universal(e.response)}).catch(function(e){throw new k("Universal search request failed","AutoComplete",e)})}}]),e}(),$t=["what is yext","who is the ceo of yext"],Zt=["near me","in new york","available now"],Xt=function(){function e(){t(this,e)}return i(e,[{key:"queryFilter",value:function(e,t){return tn()}},{key:"queryVertical",value:function(e,t){return en(e,Zt.map(function(e){return"".concat(t," ").concat(e)}).concat($t))}},{key:"queryUniversal",value:function(e){return en(e,$t)}}]),e}();function en(e,t){if(0===e.length)return tn();var n=e.toLowerCase(),i=t.filter(function(e){return e.includes(n)}).map(function(e){return new Yt({value:e,matchedSubstrings:[{offset:e.indexOf(n),length:n.length}]})});return Promise.resolve(new Gt({sections:[{results:i}],queryId:nn()}))}function tn(){return Promise.resolve(new Gt({sections:[{}],queryId:nn()}))}function nn(){return Math.random().toString(36).substring(2)}var rn=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t(this,e),!n.apiKey)throw new _("Api Key is required","QuestionAnswerApi");this._apiKey=n.apiKey}return i(e,[{key:"submitQuestion",value:function(e){return new ne({baseUrl:"https://api.yext.com",endpoint:"/v2/accounts/me/questions",apiKey:this._apiKey,params:{entityId:e.entityId,site:e.site,name:e.name,email:e.email,questionText:e.questionText,questionDescription:e.questionDescription,questionLanguage:e.questionLanguage}}).post({mode:"cors",headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).catch(function(e){throw new k("Question submit failed","QuestionAnswerApi",e)})}}]),e}(),on=function(){function e(){t(this,e)}return i(e,[{key:"submitQuestion",value:function(e){return Promise.resolve({})}}]),e}(),an=919871,sn=function(){function e(){t(this,e),this._getMockDataJson=fetch("https://assets.sitescdn.net/answers/testdata/search/mockdata_v1.json").then(function(e){return e.text()}).catch(console.error)}return i(e,[{key:"verticalSearch",value:function(e,t){var n=t.input,i=(t.filter,t.facetFilter,t.limit),r=t.offset;t.id,t.geolocation,t.isDynamicFiltersEnabled,t.skipSpellCheck,t.queryTrigger;return this.useMockData(function(t){if(""===n)return pn(hn({results:[],appliedQueryFilters:[]}));var o=t.find(function(t){return e===t.verticalConfigId});return null==o&&(o=t[Math.floor(Math.random()*t.length)]),un(o,ln(n)),null!=r&&null!=i&&un(o,function e(t){return t.slice(r,r+e)}),pn(hn(o))})}},{key:"universalSearch",value:function(e,t){return this.useMockData(function(t){return""===e?pn(cn([])):(t.forEach(function(t){un(t,ln(e))}),pn(cn(t=t.filter(function(e){return e.results.length>0}))))})}},{key:"useMockData",value:function(e){return this._getMockDataJson.then(JSON.parse).then(e)}}]),e}();function ln(e){return function(t){return t.filter(function(t){if(t.htmlTitle&&t.htmlTitle.toLowerCase().includes(e))return!0;for(var n in t.data){var i=t.data[n];if("string"==typeof i&&i.toLowerCase().includes(e))return!0}return!1})}}function un(e,t){e.results=t(e.results)}function cn(e){return e=e.map(fn),{meta:{uuid:dn(),errors:[]},response:{businessId:an,modules:e,failedVerticals:[],queryId:dn(),searchIntents:[]}}}function hn(e){return e=fn(e),{meta:{uuid:dn(),errors:[]},response:Object.assign(e,{businessId:an,queryId:dn(),searchIntents:[]})}}function fn(e){return{verticalConfigId:e.verticalConfigId,resultsCount:e.results.length,encodedState:"",results:e.results,appliedQueryFilters:e.appliedQueryFilters,queryDurationMillis:gn(50,1e3),facets:e.facets,source:e.source}}function pn(e){return new Promise(function(t){setTimeout(function(){t(e)},gn(250,1e3))})}function dn(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function gn(e,t){return Math.floor(Math.random()*(t-e)+e)}var vn={locale:"en"};return new(function(){function e(){if(t(this,e),!e.setInstance(this))return e.getInstance();this.Component=ue,this.AnalyticsEvent=re,this.renderer=new Q.Handlebars,this.components=Ht,this.core=null,this._onReady=function(){},this._eligibleForAnalytics=!1,this._services=null,this._analyticsReporterService=null}return i(e,[{key:"init",value:function(e){var t=this;if("string"!=typeof(e=Object.assign({},vn,e)).apiKey)throw new Error("Missing required `apiKey`. Type must be {string}");if("string"!=typeof e.experienceKey)throw new Error("Missing required `experienceKey`. Type must be {string}");e.search=new Qt(e.search);var n=new le,i=new zt({updateListener:e.onStateChange,resetListener:function(e){return n.setAll(e)}});n.setAll(i.getAll()),n.set(N.SEARCH_CONFIG,e.search);var r=!0;if("boolean"==typeof e.sessionTrackingEnabled&&(r=e.sessionTrackingEnabled),n.set(N.SESSIONS_OPT_IN,r),this._services=e.mock?{searchService:new sn,autoCompleteService:new Xt,questionAnswerService:new on,errorReporterService:new Bt}:function(e){return{searchService:new ie({apiKey:e.apiKey,experienceKey:e.experienceKey,experienceVersion:e.experienceVersion,locale:e.locale}),autoCompleteService:new Wt({apiKey:e.apiKey,experienceKey:e.experienceKey,experienceVersion:e.experienceVersion,locale:e.locale}),questionAnswerService:new rn({apiKey:e.apiKey}),errorReporterService:new Vt({apiKey:e.apiKey,experienceKey:e.experienceKey,experienceVersion:e.experienceVersion,printVerbose:e.debug,sendToServer:!e.suppressErrorReports})}}(e),this.core=new H({apiKey:e.apiKey,globalStorage:n,persistentStorage:i,experienceKey:e.experienceKey,fieldFormatters:e.fieldFormatters,experienceVersion:e.experienceVersion,locale:e.locale,searchService:this._services.searchService,autoCompleteService:this._services.autoCompleteService,questionAnswerService:this._services.questionAnswerService}),e.onStateChange&&"function"==typeof e.onStateChange&&e.onStateChange(i.getAll(),window.location.search.substr(1)),this.components.setCore(this.core).setRenderer(this.renderer),this._eligibleForAnalytics=null!=e.businessId,this._eligibleForAnalytics){var o=e.mock?new ae:new oe(this.core,e.experienceKey,e.experienceVersion,e.businessId,e.analyticsOptions);this._analyticsReporterService=o,this.components.setAnalyticsReporter(o),function(e){var t=null,n=function(){if(window.innerHeight+window.pageYOffset>=document.body.scrollHeight){var t=new re("SCROLL_TO_BOTTOM_OF_PAGE");e.report(t)}};document.addEventListener("scroll",function(){clearTimeout(t),t=setTimeout(n,100)})}(o)}return this._setDefaultInitialSearch(e.search),this._onReady=e.onReady||function(){},!1===e.useTemplates||e.templateBundle?(e.templateBundle&&this.renderer.init(e.templateBundle),this._onReady(),this):(this.templates=new jt({templateUrl:e.templateUrl}).onLoaded(function(e){t.renderer.init(e),t._onReady()}),this)}},{key:"domReady",value:function(e){V.onReady(e)}},{key:"onReady",value:function(e){return this._onReady=e,this}},{key:"registerComponentType",value:function(e){this.components.register(e)}},{key:"addComponent",value:function(e,t){"string"==typeof t&&(t={container:t});try{this.components.create(e,t).mount()}catch(t){throw new b("Failed to add component",e,t)}return this}},{key:"removeComponent",value:function(e){this.components.removeByName(e)}},{key:"createComponent",value:function(e){return this.components.create("Component",e).mount()}},{key:"registerHelper",value:function(e,t){return this.renderer.registerHelper(e,t),this}},{key:"setConversionsOptIn",value:function(e){this._eligibleForAnalytics&&this._analyticsReporterService.setConversionTrackingEnabled(e)}},{key:"setSessionsOptIn",value:function(e){this.core.globalStorage.set(N.SESSIONS_OPT_IN,e)}},{key:"_setDefaultInitialSearch",value:function(e){null!=e.defaultInitialSearch&&e.verticalKey&&(null==this.core.globalStorage.getState(N.QUERY)&&(this.core.globalStorage.set("queryTrigger","initialize"),this.core.setQuery(e.defaultInitialSearch)))}}],[{key:"setInstance",value:function(e){return!this.instance&&(this.instance=e,!0)}},{key:"getInstance",value:function(){return this.instance}}]),e}())});